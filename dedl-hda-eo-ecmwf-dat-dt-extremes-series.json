{"version":2,"kind":"Notebook","sha256":"39867270ff5cd4ab284817ee826556f9fda09c6aab8a4d00ab8ac401dab0a72b","slug":"dedl-hda-eo-ecmwf-dat-dt-extremes-series","location":"/HDA/DestinE_Digital_Twins/DEDL-HDA-EO.ECMWF.DAT.DT_EXTREMES-Series.ipynb","dependencies":[],"frontmatter":{"title":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","content_includes_title":true,"kernelspec":{"name":"python_dedl","display_name":"Python DEDL","language":"python"},"numbering":{"title":{"offset":2}},"thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","exports":[{"format":"ipynb","filename":"DEDL-HDA-EO.ECMWF.DAT.DT_EXTREMES-Series.ipynb","url":"/build/DEDL-HDA-EO.ECMWF.DA-b9fc29853cfd04e5dbe0c867c1265134.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"image","url":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ni7ENSqz5F","urlSource":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/img/DestinE-banner.jpg?raw=true"}],"visibility":"show","key":"xDDw1znSIL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XJmZSxBOkg"}],"key":"KoHZ2FQHAc"},{"type":"text","value":": EUMETSAT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IJqZLcuHcN"},{"type":"break","key":"ogJeHvaevc"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C9dqrPq2r0"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copyright","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sd6eOJwlYJ"}],"key":"lxooRfFCQZ"},{"type":"text","value":": 2024 EUMETSAT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EH87YrDpDa"},{"type":"break","key":"eqLouByd3r"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eLjnXwUmfy"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YO2gKFLf6C"}],"key":"nWK9rz6b8D"},{"type":"text","value":": MIT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"we42AlSxe1"},{"type":"break","key":"JqNFyqtlln"}],"key":"P4GhIzFqZh"},{"type":"heading","depth":1,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QhSue82a1j"}],"identifier":"destination-earth-weather-induced-extremes-digital-twin-data-access-using-dedl-hda","label":"Destination Earth - Weather-Induced Extremes Digital Twin - Data Access using DEDL HDA","html_id":"destination-earth-weather-induced-extremes-digital-twin-data-access-using-dedl-hda","implicit":true,"key":"vO2Ti3eLir"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://destine-data-lake-docs.data.destination-earth.eu/en/latest/dedl-discovery-and-data-access/Introduction-to-Discovery-and-Data-Access-services/Introduction-to-Discovery-and-Data-Access-services.html#hda-harmonised-data-access","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Documentation DestinE Data Lake HDA","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BIYWoENXOO"}],"urlSource":"https://destine-data-lake-docs.data.destination-earth.eu/en/latest/dedl-discovery-and-data-access/Introduction-to-Discovery-and-Data-Access-services/Introduction-to-Discovery-and-Data-Access-services.html#hda-harmonised-data-access","key":"c5spOyicUg"}],"key":"autf4NUlVI"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"https://confluence.ecmwf.int/display/DDCZ/DestinE+Parameter+Portfolios","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Documentation Digital Twin - Parameter Usage","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QSsPTStUAe"}],"urlSource":"https://confluence.ecmwf.int/display/DDCZ/DestinE+Parameter+Portfolios","key":"ZmirVmCYim"}],"key":"Ifp6CYAW75"}],"key":"SZqfJoi87i"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"break","key":"s8GGKuLA4y"},{"type":"text","value":" Author: EUMETSAT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R8MRTcqEJN"}],"key":"MM3NPne8VO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Credit: Earthkit and HDA Polytope used in this context are both packages provided by the European Centre for Medium-Range Weather Forecasts (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nyyy4D2Kdj"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ECMWF","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fmdW1lql9l"}],"key":"lldFFJipNe"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e57Az8DcOe"}],"key":"tj7vONlW4T"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"DEDL Harmonised Data Access is used in this example.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XvHRj0X30M"}],"key":"aFvIDixbH9"}],"key":"s3WR3AgYAf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Obtain Authentication Token","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fdy3J6cuUO"}],"identifier":"obtain-authentication-token","label":"Obtain Authentication Token","html_id":"obtain-authentication-token","implicit":true,"key":"UMvAjykBa3"}],"key":"pYWXr3tX7j"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import requests\nfrom requests.adapters import HTTPAdapter\nfrom urllib3.util.retry import Retry\nimport ipywidgets as widgets\nimport json\nimport os\nfrom getpass import getpass\nimport destinelab as deauth\nfrom datetime import datetime, timedelta","visibility":"show","key":"TAezQicW22"},{"type":"output","id":"I13TD4Zc_JufTC66miKLX","data":[],"visibility":"show","key":"SxfmRLxOku"}],"visibility":"show","key":"XFqaKQ7XWb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First, we get an access token for the API","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r3vF3XOH3U"}],"key":"zi9ubStWQX"}],"key":"IPzmQ1fMvN"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"DESP_USERNAME = input(\"Please input your DESP username or email: \")\nDESP_PASSWORD = getpass(\"Please input your DESP password: \")\n\nauth = deauth.AuthHandler(DESP_USERNAME, DESP_PASSWORD)\naccess_token = auth.get_token()\nif access_token is not None:\n    print(\"DEDL/DESP Access Token Obtained Successfully\")\nelse:\n    print(\"Failed to Obtain DEDL/DESP Access Token\")\n\nauth_headers = {\"Authorization\": f\"Bearer {access_token}\"}","visibility":"show","key":"A8Ev29R0Jd"},{"type":"output","id":"hWa1PWlbnVfZjXQ9Hh4GT","data":[{"name":"stdin","output_type":"stream","text":"Please input your DESP username or email:  eum-dedl-user\nPlease input your DESP password:  ········\n"},{"name":"stdout","output_type":"stream","text":"Response code: 200\nDEDL/DESP Access Token Obtained Successfully\n"}],"visibility":"show","key":"eFa7bga0dm"}],"visibility":"show","key":"koWf2IXUtf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check if DT access is granted","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gDRxXYsKDh"}],"identifier":"check-if-dt-access-is-granted","label":"Check if DT access is granted","html_id":"check-if-dt-access-is-granted","implicit":true,"key":"L4eLgwLYwz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If DT access is not granted, you will not be able to execute the rest of the notebook.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SlQdYW1Pyx"}],"key":"q7UgCMZn80"}],"key":"Wesn8PZP5G"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import importlib\ninstalled_version = importlib.metadata.version(\"destinelab\")\nversion_number = installed_version.split('.')[1]\nif((int(version_number) >= 8 and float(installed_version) < 1) or float(installed_version) >= 1):\n    auth.is_DTaccess_allowed(access_token)","visibility":"show","key":"NWAkNCJN70"},{"type":"output","id":"ly00SUsAcrdzNHCk-9mVa","data":[{"name":"stdout","output_type":"stream","text":"DT Output access allowed\n"}],"visibility":"show","key":"Tc2w36Nqhd"}],"visibility":"show","key":"rcfTFZLriT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Query using the DEDL HDA API","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D7SUY0b2M8"}],"identifier":"query-using-the-dedl-hda-api","label":"Query using the DEDL HDA API","html_id":"query-using-the-dedl-hda-api","implicit":true,"key":"fULrQPZIrJ"}],"key":"uCJqV9j7Co"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Filter","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dgVBZSi5Cy"}],"identifier":"filter","label":"Filter","html_id":"filter","implicit":true,"key":"lZM25zG3Lt"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We have to setup up a filter and define which data to obtain.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"buktZCGBt2"}],"key":"IZD0d4MKhb"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Extreme DT data is available for specific time ranges (last 14 days) around the current date.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dMt6smFS6b"}],"key":"Ged7R3S1Qw"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"It is possible to use the ECMWF Aviso package to check data availability in the last 14 days (see ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"FwHIcxjQPx"},{"type":"link","url":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/HDA/DestinE%20Digital%20Twins/ExtremeDT-dataAvailability.ipynb","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/HDA/DestinE Digital Twins/ExtremeDT-dataAvailability.ipynb","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"MeSD6Na6hH"}],"urlSource":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/HDA/DestinE%20Digital%20Twins/ExtremeDT-dataAvailability.ipynb","data":{"kind":"file","org":"destination-earth","repo":"DestinE-DataLake-Lab","reference":"main","file":"HDA/DestinE%20Digital%20Twins/ExtremeDT-dataAvailability.ipynb","raw":"https://raw.githubusercontent.com/destination-earth/DestinE-DataLake-Lab/main/HDA/DestinE%20Digital%20Twins/ExtremeDT-dataAvailability.ipynb"},"internal":false,"protocol":"github","key":"iVFfmH8vlN"},{"type":"text","value":" or ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AF2TLEKhlB"},{"type":"link","url":"https://github.com/destination-earth-digital-twins/polytope-examples/blob/main/extremes-dt/extremes-dt.py","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"extremes​-dt​/extremes​-dt​.py","key":"qaf1R6L4mK"}],"urlSource":"https://github.com/destination-earth-digital-twins/polytope-examples/blob/main/extremes-dt/extremes-dt.py","data":{"kind":"file","org":"destination-earth-digital-twins","repo":"polytope-examples","reference":"main","file":"extremes-dt/extremes-dt.py","raw":"https://raw.githubusercontent.com/destination-earth-digital-twins/polytope-examples/main/extremes-dt/extremes-dt.py"},"internal":false,"protocol":"github","key":"Lhu6Apo3Zd"},{"type":"text","value":") and request data accordingly.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"y37IrkSLap"}],"key":"RLOBFh39as"}],"key":"hySKaGWuXm"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from datetime import datetime, timedelta\n\n# Get the current date and time in UTC\ncurrent_date = datetime.utcnow()\n\n# Calculate the date 15 days before the current date\ndate_14_days_ago = current_date - timedelta(days=14)\n\n# Format the date as YYYYMMDD and set the time to 0000 UTC\nformatted_date = date_14_days_ago.strftime('%Y%m%d') + '0000'\n# Convert the formatted date back to a datetime object\ndate_from = datetime.strptime(formatted_date, '%Y%m%d%H%M%S').date()\n\n# Format the date as YYYYMMDD and set the time to 0000 UTC\nformatted_date = current_date.strftime('%Y%m%d') + '0000'\n# Convert the formatted date back to a datetime object\ndate_to = datetime.strptime(formatted_date, '%Y%m%d%H%M%S').date()","visibility":"show","key":"g6gP1my6V1"},{"type":"output","id":"Cv_yLvgmF2C0p8D4tWKOQ","data":[],"visibility":"show","key":"vCxHBnMQJR"}],"visibility":"show","key":"kRnM2KxPaC"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"start_date_picker = widgets.DatePicker(description='Start Date:', disabled=False)\n\n# Set initial values directly\nstart_date_picker.min = date_from\nstart_date_picker.max = date_to\nstart_date_picker.value = date_from\n\ndef get_selected_values():\n    selected_start_date = start_date_picker.value\n    return selected_start_date\n\n# Display widgets\ndisplay(start_date_picker)\n","visibility":"show","key":"CnjtKNvrNy"},{"type":"output","id":"As-m5WGJ7KR8NkjD6ljjZ","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"1ce53caaa4074c5793af0cf228024fdb\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"DatePicker(value=datetime.date(2025, 3, 11), description='Start Date:', max=datetime.date(2025, 3, 25), min=da…","content_type":"text/plain"}}}],"visibility":"show","key":"XxufGntnnG"}],"visibility":"show","key":"NgN6phhPbZ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Example usage:\ndatechoice = get_selected_values().strftime(\"%Y-%m-%dT%H:%M:%SZ\")\n#print(datechoice)\nfilters = {\n    key: {\"eq\": value}\n    for key, value in {\n        \"class\": \"d1\",             # fixed (rd or d1)\n        \"dataset\": \"extremes-dt\",  # fixed extreme dt \n        \"expver\": \"0001\",          # fixed experiment version \n        \"stream\": \"oper\",          # fixed oper\n        \"step\": \"0/6/12/18/24\",    # Forcast step hourly (1..96)\n        \"type\": \"fc\",              # fixed forecasted fields\n        \"levtype\": \"sfc\",          # Surface fields (levtype=sfc), Height level fields (levtype=hl), Pressure level fields (levtype=pl), Model Level (Levtype=ml)\n        \"param\": \"151/228029\"      # 10m Wind gust & Mean Sea Level Pressure\n    }.items()\n}","visibility":"show","key":"pywqqAQrOk"},{"type":"output","id":"kioW-oeS_moXd1i8kgsZV","data":[],"visibility":"show","key":"VrivPb45Za"}],"visibility":"show","key":"qseq7IBWQx"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Make Data Request","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TflAOUfqii"}],"identifier":"make-data-request","label":"Make Data Request","html_id":"make-data-request","implicit":true,"key":"w1y6k5gUdh"}],"visibility":"show","key":"hUiX6MjgAx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#Sometimes requests to polytope get timeouts, it is then convenient define a retry strategy\nretry_strategy = Retry(\n    total=5,  # Total number of retries\n    status_forcelist=[500, 502, 503, 504],  # List of 5xx status codes to retry on\n    allowed_methods=[\"GET\",'POST'],  # Methods to retry\n    backoff_factor=1  # Wait time between retries (exponential backoff)\n)\n\n# Create an adapter with the retry strategy\nadapter = HTTPAdapter(max_retries=retry_strategy)\n\n# Create a session and mount the adapter\nsession = requests.Session()\nsession.mount(\"https://\", adapter)\n\nresponse = session.post(\"https://hda.data.destination-earth.eu/stac/search\", headers=auth_headers, json={\n    \"collections\": [\"EO.ECMWF.DAT.DT_EXTREMES\"],\n    \"datetime\": datechoice,\n    \"query\": filters\n})\n\n# Requests to EO.ECMWF.DAT.DT_EXTREMES always return a single item containing all the requested data\nif(response.status_code!= 200):\n    (print(response.text))\nresponse.raise_for_status()\n\nproduct = response.json()[\"features\"][0]\nproduct[\"id\"]\n#product","visibility":"show","key":"HSPIne8Q9m"},{"type":"output","id":"rmJxAYTctHKgiAsqx1CbB","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"'DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce'","content_type":"text/plain"}}}],"visibility":"show","key":"uqmicUhPUT"}],"visibility":"show","key":"ISV5YpgXPa"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Submission worked ? Once our product found, we download the data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xlynV1wrMS"}],"identifier":"submission-worked-once-our-product-found-we-download-the-data","label":"Submission worked ? Once our product found, we download the data.","html_id":"submission-worked-once-our-product-found-we-download-the-data","implicit":true,"key":"kwUmn7tRbQ"}],"key":"bYcoAIMrrU"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import JSON\n\n# DownloadLink is an asset representing the whole product\ndownload_url = product[\"assets\"][\"downloadLink\"][\"href\"]\n\nHTTP_SUCCESS_CODE = 200\nHTTP_ACCEPTED_CODE = 202\n\ndirect_download_url=''\n\nresponse = session.get(download_url, headers=auth_headers)\nif (response.status_code == HTTP_SUCCESS_CODE):\n    direct_download_url = product['assets']['downloadLink']['href']\nelif (response.status_code != HTTP_ACCEPTED_CODE):\n    print(response.text)\n\nresponse.raise_for_status()    \nprint(download_url)   ","visibility":"show","key":"xXFmR2aSL4"},{"type":"output","id":"nqmMroYO0RZ3R8gwjs9qy","data":[{"name":"stdout","output_type":"stream","text":"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?provider=dedt_lumi&_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D\n"}],"visibility":"show","key":"GkfNodt7C6"}],"visibility":"show","key":"OzScmXkcrl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Wait until data is there","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mgdyjEtz4P"}],"identifier":"wait-until-data-is-there","label":"Wait until data is there","html_id":"wait-until-data-is-there","implicit":true,"key":"dEPnrDgW1W"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This data is not available at the moment. And we can see that our request is in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HhNRua0Tf0"},{"type":"inlineCode","value":"queued","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zrIbbAr2lN"},{"type":"text","value":"status.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zNlXTeiwP6"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PoD7WjBQ20"},{"type":"text","value":"We will now poll the API until the data is ready and then download it.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QM4dubTKiU"}],"key":"VaS80eoV1B"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Please note that the basic HDA quota allows a maximum of 4 requests per second. The following code limits polling to this quota.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QrxXkGry7t"}],"key":"L1fMcPHmbz"}],"key":"V4yLmTWpyD"}],"key":"mwjs6xoklt"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"pip install ratelimit --quiet","visibility":"show","key":"wqpo9UNcez"},{"type":"output","id":"eFbUUbQ-yz6j1_-ltiRnm","data":[{"name":"stdout","output_type":"stream","text":"Note: you may need to restart the kernel to use updated packages.\n"}],"visibility":"show","key":"fJW4tibH9A"}],"visibility":"show","key":"CQkPc4T0aa"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from tqdm import tqdm\nimport time\nimport re\nfrom tqdm import tqdm\nimport time\nimport re\nfrom ratelimit import limits, sleep_and_retry\n\n# Set limit: max 4 calls per 1 seconds\nCALLS = 4\nPERIOD = 1  # seconds\n\n@sleep_and_retry\n@limits(calls=CALLS, period=PERIOD)\ndef call_api(url,auth_headers):\n    response = session.get(url, headers=auth_headers, stream=True)\n    return response\n\n# we poll as long as the data is not ready\nif direct_download_url=='':\n    while url := response.headers.get(\"Location\"):\n        print(f\"order status: {response.json()['status']}\")\n        print(f\"order status: {response.text}\")\n        response = call_api(url,auth_headers)  \n        \nif (response.status_code not in (HTTP_SUCCESS_CODE,HTTP_ACCEPTED_CODE)):\n    (print(response.text))\n\n        \n# Check if Content-Disposition header is present\nif \"Content-Disposition\" not in response.headers:\n    print(response)\n    print(response.text)\n    raise Exception(\"Headers: \\n\"+str(response.headers)+\"\\nContent-Disposition header not found in response. Must be something wrong.\")\n        \nfilename = re.findall('filename=\\\"?(.+)\\\"?', response.headers[\"Content-Disposition\"])[0]\ntotal_size = int(response.headers.get(\"content-length\", 0))\n\nprint(f\"downloading {filename}\")\n\nwith tqdm(total=total_size, unit=\"B\", unit_scale=True) as progress_bar:\n    with open(filename, 'wb') as f:\n        for data in response.iter_content(1024):\n            progress_bar.update(len(data))\n            f.write(data)","visibility":"show","key":"ym4SQAPLSj"},{"type":"output","id":"hBVwvWtcZNF07avKLbk1E","data":[{"name":"stdout","output_type":"stream","text":"order status: queued\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"queued\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\norder status: processing\norder status: {\"description\":\"Product is not available yet, please try again using given updated location\",\"status\":\"processing\",\"location\":\"https://hda.data.destination-earth.eu/stac/collections/EO.ECMWF.DAT.DT_EXTREMES/items/DT_EXTREMES_20250324_20250324_e25adab045e5148cf5649dd69b25374adda5e2ce/download?_dc_qs=%257B%2522class%2522%253A%2B%2522d1%2522%252C%2B%2522dataset%2522%253A%2B%2522extremes-dt%2522%252C%2B%2522date%2522%253A%2B%252220250324%252Fto%252F20250324%2522%252C%2B%2522expver%2522%253A%2B%25220001%2522%252C%2B%2522levtype%2522%253A%2B%2522sfc%2522%252C%2B%2522param%2522%253A%2B%2522151%252F228029%2522%252C%2B%2522step%2522%253A%2B%25220%252F6%252F12%252F18%252F24%2522%252C%2B%2522stream%2522%253A%2B%2522oper%2522%252C%2B%2522time%2522%253A%2B%25220000%2522%252C%2B%2522type%2522%253A%2B%2522fc%2522%257D&message=Request+queued&status=queued&orderId=48c161b2-bd5b-4868-9d17-937f4c8596e2&provider=dedt_lumi\"}\ndownloading 48c161b2-bd5b-4868-9d17-937f4c8596e2.grib\n"},{"name":"stderr","output_type":"stream","text":"100%|██████████| 534M/534M [00:25<00:00, 21.2MB/s] \n"}],"visibility":"show","key":"spolGEaDFd"}],"visibility":"show","key":"oou6BZb9QP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Render the sea ice coverage on a map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AUIQDnEoxG"}],"identifier":"render-the-sea-ice-coverage-on-a-map","label":"Render the sea ice coverage on a map","html_id":"render-the-sea-ice-coverage-on-a-map","implicit":true,"key":"Dhgbv4yBc5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Lets plot the result file","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G76EEHMGNU"}],"key":"DE9ukLAehn"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This section requires that you have ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Pzv6b8O4h8"},{"type":"inlineCode","value":"ecCodes >= 2.35","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"G4uOUCjBDE"},{"type":"text","value":" installed on your system.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"L0h2b2mNGE"},{"type":"break","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BNaO8Ddlj1"},{"type":"text","value":"You can follow the installation procedure at ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"juBEha2By6"},{"type":"link","url":"https://confluence.ecmwf.int/display/ECC/ecCodes+installation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​confluence​.ecmwf​.int​/display​/ECC​/ecCodes+installation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SfjE6R3jPB"}],"urlSource":"https://confluence.ecmwf.int/display/ECC/ecCodes+installation","key":"OluOrgLLWX"}],"key":"iZu2cd1rO5"}],"key":"LZBGL1QPFm"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import earthkit.data\nimport earthkit.maps\n\ndata = earthkit.data.from_source(\"file\", filename)\ndata.ls()","visibility":"show","key":"A99YC5Lwrw"},{"type":"output","id":"fcuYfeEQhAhYmnSrzenwK","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>centre</th>\n      <th>shortName</th>\n      <th>typeOfLevel</th>\n      <th>level</th>\n      <th>dataDate</th>\n      <th>dataTime</th>\n      <th>stepRange</th>\n      <th>dataType</th>\n      <th>number</th>\n      <th>gridType</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>ecmf</td>\n      <td>msl</td>\n      <td>meanSea</td>\n      <td>0</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>0</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>ecmf</td>\n      <td>i10fg</td>\n      <td>heightAboveGround</td>\n      <td>10</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>0</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>ecmf</td>\n      <td>msl</td>\n      <td>meanSea</td>\n      <td>0</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>6</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>ecmf</td>\n      <td>i10fg</td>\n      <td>heightAboveGround</td>\n      <td>10</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>6</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>ecmf</td>\n      <td>msl</td>\n      <td>meanSea</td>\n      <td>0</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>12</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>ecmf</td>\n      <td>i10fg</td>\n      <td>heightAboveGround</td>\n      <td>10</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>12</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>ecmf</td>\n      <td>msl</td>\n      <td>meanSea</td>\n      <td>0</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>18</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>ecmf</td>\n      <td>i10fg</td>\n      <td>heightAboveGround</td>\n      <td>10</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>18</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>ecmf</td>\n      <td>msl</td>\n      <td>meanSea</td>\n      <td>0</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>24</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>ecmf</td>\n      <td>i10fg</td>\n      <td>heightAboveGround</td>\n      <td>10</td>\n      <td>20250324</td>\n      <td>0</td>\n      <td>24</td>\n      <td>fc</td>\n      <td>None</td>\n      <td>reduced_gg</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"  centre shortName        typeOfLevel  level  dataDate  dataTime stepRange  \\\n0   ecmf       msl            meanSea      0  20250324         0         0   \n1   ecmf     i10fg  heightAboveGround     10  20250324         0         0   \n2   ecmf       msl            meanSea      0  20250324         0         6   \n3   ecmf     i10fg  heightAboveGround     10  20250324         0         6   \n4   ecmf       msl            meanSea      0  20250324         0        12   \n5   ecmf     i10fg  heightAboveGround     10  20250324         0        12   \n6   ecmf       msl            meanSea      0  20250324         0        18   \n7   ecmf     i10fg  heightAboveGround     10  20250324         0        18   \n8   ecmf       msl            meanSea      0  20250324         0        24   \n9   ecmf     i10fg  heightAboveGround     10  20250324         0        24   \n\n  dataType number    gridType  \n0       fc   None  reduced_gg  \n1       fc   None  reduced_gg  \n2       fc   None  reduced_gg  \n3       fc   None  reduced_gg  \n4       fc   None  reduced_gg  \n5       fc   None  reduced_gg  \n6       fc   None  reduced_gg  \n7       fc   None  reduced_gg  \n8       fc   None  reduced_gg  \n9       fc   None  reduced_gg  ","content_type":"text/plain"}}}],"visibility":"show","key":"LvUtOxMHBp"}],"visibility":"show","key":"JLSeD6UpoV"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\nchart = earthkit.maps.Chart(domain=[-5, 23, 40, 58], rows=3, columns=4)\n\ngust_style = earthkit.maps.Style(\n    colors=[\"#85AAEE\", \"#208EFC\", \"#6CA632\", \"#FFB000\", \"#FF0000\", \"#7A11B1\"],\n    levels=[12, 15, 20, 25, 30, 35, 50],\n    units=\"m s-1\",\n)\n\nchart.add_subplot(row=0, column=3)\nfor i in range(4):\n    chart.add_subplot(row=1+i//4, column=i%4)\n\nchart.plot(data.sel(shortName=\"i10fg\"), style=gust_style)\nchart.plot(data.sel(shortName=\"msl\"), units=\"hPa\")\n\nchart.land(color=\"lightgrey\")\nchart.coastlines()\n\nax = plt.axes((0.05, 0.8, 0.65, 0.025))\nchart.legend(ax=ax)\n\nchart.subplot_titles(\"{time:%Y-%m-%d %H} UTC (+{lead_time}h)\")\nchart.title(\n    \"ECMWF HRES Run: {base_time:%Y-%m-%d %H} UTC\\n{variable_name}\",\n    fontsize=15, horizontalalignment=\"left\", x=0, y=0.96,\n)\n\nchart.show()","visibility":"show","key":"k4NyC0ryrj"},{"type":"output","id":"gjrATv-eH_S_tSPvGVwDY","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"78b0470d3759dcd0cc90431f61cb0688","path":"/build/78b0470d3759dcd0cc90431f61cb0688.png"},"text/plain":{"content":"<Figure size 900x750 with 6 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"x9Agrdi9Y8"}],"visibility":"show","key":"PTUt5NDAzS"}],"key":"mqbZxb1fMl"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Destination Earth - Climate Change Adaptation Digital Twin Series Plot- Data Access using DEDL HDA","url":"/dedl-hda-eo-ecmwf-dat-dt-climate-series","group":"HDA"},"next":{"title":"Destination Earth - Climate Change Adaptation Digital Twin - Data Access using DEDL HDA","url":"/dedl-hda-eo-ecmwf-dat-dt-climate","group":"HDA"}}},"domain":"http://localhost:3001"}