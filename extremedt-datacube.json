{"version":2,"kind":"Notebook","sha256":"bb90703121ff6f693d48ed8f1dc9a2dfae540ec12787b592c28b2eae0a1d16ec","slug":"extremedt-datacube","location":"/STACK/ExtremeDT-DataCube.ipynb","dependencies":[],"frontmatter":{"title":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","content_includes_title":true,"kernelspec":{"name":"python_dedl","display_name":"Python DEDL","language":"python"},"numbering":{"title":{"offset":2}},"thumbnail":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","exports":[{"format":"ipynb","filename":"ExtremeDT-DataCube.ipynb","url":"/build/ExtremeDT-DataCube-fbca141337c52b9375f86f142dfe4a7b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/build/b27bd30f978ddf0848f3ea0942070886.jpeg","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GjzXmQpEqY","urlSource":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/img/DestinE-banner.jpg?raw=true"}],"key":"QStWq80JB8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CJVqQFUCAX"}],"key":"YFO24HTdri"},{"type":"text","value":": MIT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dB6o3AsqVB"},{"type":"break","key":"Tiru7XSA1s"}],"key":"yLZ91RB6Hm"},{"type":"heading","depth":1,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fgBa7HdPg6"}],"identifier":"data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","label":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","html_id":"data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","implicit":true,"key":"n2psQxXCX6"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook covers:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OhHMVVrA5T"}],"key":"LQrlxmnXa6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"find available data cubes and their urls","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"u9oYkyjye5"}],"key":"CJODzXqhCn"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"upload data cube","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"szvYna2Ljs"}],"key":"ht3AAUstZA"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"plot map for desired area, time and variable","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Tni7FoH7ca"}],"key":"DVRHQm4FpN"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"plot time series chart for selected variable in specifc time for specific location","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"o5qaep1Zbc"}],"key":"Ec0f5Z6OfN"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"create interactive dashboard using xcube - xviewer","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Yp1O0T7xfc"}],"key":"hbXnStopdr"}],"key":"wEWynDssdv"}],"key":"HE7mlutEtt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepre your environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f4cyDjGDuP"}],"identifier":"prepre-your-environment","label":"Prepre your environment","html_id":"prepre-your-environment","implicit":true,"key":"Kp7opdDJeI"}],"key":"qzGsUZgtFA"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import xarray as xr\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport dask\nimport requests","visibility":"show","key":"hw3XMuCpjn"},{"type":"output","id":"Ar2BI8D18ipKbKKQQKeRn","data":[],"visibility":"show","key":"um8ZRL86OO"}],"visibility":"show","key":"WwaoQQrTKv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Connect with Extreme DT data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p7AERbQ5Yc"}],"identifier":"connect-with-extreme-dt-data-cube","label":"Connect with Extreme DT data cube","html_id":"connect-with-extreme-dt-data-cube","implicit":true,"key":"PXtfgk0FOl"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The data cube provides data:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ex6solwQ7S"}],"key":"gReIzsmibn"}],"key":"mA6OypT6hz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Four variables","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KOYbvp6g6o"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2t - Air temperature at 2 meters above grond [K]","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ESkFZVUgti"}],"key":"eOe1Tv58RJ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2d - Dew point temperature at 2 meters above grond [K]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YZa5ALDORG"}],"key":"SKk4WG3lkD"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sp - Surface pressure [Pa]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yF6MuxHfUi"}],"key":"dhy4BJYl5l"}],"key":"eI7jmZ8PzQ"}],"key":"aNHj18FmNZ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Forecast from 10.04.2024 + 96 hours","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lB3zpiCoUH"}],"key":"ErWpcSonVG"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Hourly step","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"C5Dr0ujwRF"}],"key":"md7frbSPpZ"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"World","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Pzoug8JDJM"}],"key":"iiA2dr49CJ"}],"key":"aD8HkzLDUX"}],"key":"LnLZWL9tch"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select proper data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCEIUabRH4"}],"identifier":"select-proper-data-cube","label":"Select proper data cube","html_id":"select-proper-data-cube","implicit":true,"key":"cNOBKpqf1e"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data cubes on s3 bucket are stored under URL ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dBhHOINHR6"},{"type":"link","url":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​s3​.central​.data​.destination​-earth​.eu​/swift​/v1​/dedl​_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sFNY0dWXqO"}],"urlSource":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","key":"VF9KWTAZEb"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BmgVTGNwFq"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FvDqA5o1Cq"},{"type":"text","value":"Data cubes are stored in two directories:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"e4pE8gNb7d"}],"key":"RynGw7w9r2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"ExtremeDT - the newest one","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"S3tMGISWAx"}],"key":"PEVgym3MR4"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"archive - from prievous days","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"i2nKMSebFv"}],"key":"VrBUUmpd6B"}],"key":"hPdHs84aal"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"File nameing convention:","key":"ereUWmcVLj"}],"key":"KXfHrkuJXC"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E1sp9ukCjh"},{"type":"text","value":"dt_extreme_YYYYMMDD.zarr/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FbEuMD9ikt"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hMavBogok5"},{"type":"text","value":"YYYYMMDD - is the date when forecast starts (step 0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lMObusWXrB"}],"key":"EQis9XBtsf"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"Results","key":"HPSgbzQtqK"}],"key":"UpiVLcOAMa"},{"type":"break","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LFWwLr99Qe"},{"type":"text","value":"After exectution of code below, the list of urls linked to available cubes will be printed.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GMJGo1I8ea"}],"key":"c1xCkpvRqN"}],"key":"pXowBo1p4Y"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# URL to s3 where  ExtremeDT data cubes are stored\ndatacube_url = 'https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube'\nresponse = requests.get(datacube_url)\n\nif response.status_code == 200:\n    lines = response.text.splitlines()\n    zarr_items = [line for line in lines if line.endswith(\".zarr\") or line.endswith(\".zarr/\")]\n    if zarr_items:\n        for item in zarr_items:\n            print(item)\n            new_url = f\"{datacube_url}/{item}\"\n            print(\"New URL:\", new_url)\n    else:\n        print(\"No .zarr files or directories found.\")\nelse:\n    print(\"Failed to fetch contents. Status code:\", response.status_code)\n","visibility":"show","key":"YVm8Zwxu82"},{"type":"output","id":"uuUA6F9ysRGnhjz796Ax_","data":[{"name":"stdout","output_type":"stream","text":"ExtremeDT/dt_extreme_20240410.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240410.zarr/\narchive/dt_extreme_20240409.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/archive/dt_extreme_20240409.zarr/\n"}],"visibility":"show","key":"zz9DzVhBKF"}],"visibility":"show","key":"Rf1Q8aiKER"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get info about the newset data cube.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NBAGLVWYKo"}],"key":"gNtjYVFsMc"}],"key":"XUtVE9OwYx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Paste into url variable link to the newest data cube\nurl = 'https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240410.zarr/'","visibility":"show","key":"rLdLVESckG"},{"type":"output","id":"CNhwgnw-RqY3m-ELNxbn2","data":[],"visibility":"show","key":"nhflmpugNV"}],"visibility":"show","key":"F04HEQ1UVZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s make some test","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c6jFepnQtP"}],"identifier":"lets-make-some-test","label":"Let’s make some test","html_id":"lets-make-some-test","implicit":true,"key":"NcybssrdWO"}],"key":"XDMOuRIa6B"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Area of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vuUvqiuPcN"}],"identifier":"area-of-interest","label":"Area of interest","html_id":"area-of-interest","implicit":true,"key":"DIsYjUOjfb"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Upload data for selected area and verify what variables are provided. In this case uplaod data for Africa. List of available variables should be returend.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uGRzS5JlwF"}],"key":"jCg5BC8xVW"}],"key":"YFIPexAe29"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"africa_bbox = [-20,     # West\n                -40,    # South\n                60,     # East\n                40]     #North\n\nafrica_dt = xr.open_zarr(url).sel(lon=slice(africa_bbox[0], \n                                            africa_bbox[2]), \n                                lat=slice(africa_bbox[3], \n                                            africa_bbox[1]),\n                                                         )\n\nlist(africa_dt.keys())","visibility":"show","key":"tXF1IDAoMs"},{"type":"output","id":"rjOAlouXvIW6fUmedrruP","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"['2d', '2t', 'sp']","content_type":"text/plain"}}}],"visibility":"show","key":"Zjt11NWaeA"}],"visibility":"show","key":"pBcMmBxMVf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot map of air temperature for Africa.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gvbu40xwUv"}],"key":"htEA0O8gcY"}],"key":"uCzJSzG2ep"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"lon = africa_dt['lon']\nlat = africa_dt['lat']\ntemperature = africa_dt['2t'][0, 0] - 273.15 # Conversion to Celcius degrees\n\nplt.figure(figsize=(10, 6))\nplt.pcolormesh(lon, lat, temperature, cmap='coolwarm')\nplt.colorbar(label='Temperature (°C)')\nplt.title('Temperature Map')\nplt.xlabel('Longitude')\nplt.ylabel('Latitude')","visibility":"show","key":"i1TENYF5Dg"},{"type":"output","id":"7iAdF7xHc9fAf-lfKykDr","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"25594f9b3cb66793800b1d9b0a416d34","path":"/build/25594f9b3cb66793800b1d9b0a416d34.png"},"text/plain":{"content":"<Figure size 1000x600 with 2 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"brbBbPdIPE"}],"visibility":"show","key":"VacjnHNDZw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get data for specific time range","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sQCKv70mO0"}],"identifier":"get-data-for-specific-time-range","label":"Get data for specific time range","html_id":"get-data-for-specific-time-range","implicit":true,"key":"bpvLa7jVji"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Get data from 10st of April to 11th of April.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Gnz0UPrMBQ"}],"key":"o9SDk0Fymy"}],"key":"KcruJ7gCRu"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"africa_bbox = [-20,     # West\n                -40,    # South\n                60,     # East\n                40]     #North\n\nafrica_dt = xr.open_zarr(url).sel(lon=slice(africa_bbox[0], \n                                            africa_bbox[2]), \n                                lat=slice(africa_bbox[3], \n                                            africa_bbox[1]),\n                                time=slice('20240410T000000', '20240411T000000')\n                                                         )\n\nprint(africa_dt.time)","visibility":"show","key":"MqkewhCGPu"},{"type":"output","id":"RsvdKldiNjP2lA7g3AAC-","data":[{"name":"stdout","output_type":"stream","text":"<xarray.DataArray 'time' (time: 25)>\narray(['2024-04-10T00:00:00.000000000', '2024-04-10T01:00:00.000000000',\n       '2024-04-10T02:00:00.000000000', '2024-04-10T03:00:00.000000000',\n       '2024-04-10T04:00:00.000000000', '2024-04-10T05:00:00.000000000',\n       '2024-04-10T06:00:00.000000000', '2024-04-10T07:00:00.000000000',\n       '2024-04-10T08:00:00.000000000', '2024-04-10T09:00:00.000000000',\n       '2024-04-10T10:00:00.000000000', '2024-04-10T11:00:00.000000000',\n       '2024-04-10T12:00:00.000000000', '2024-04-10T13:00:00.000000000',\n       '2024-04-10T14:00:00.000000000', '2024-04-10T15:00:00.000000000',\n       '2024-04-10T16:00:00.000000000', '2024-04-10T17:00:00.000000000',\n       '2024-04-10T18:00:00.000000000', '2024-04-10T19:00:00.000000000',\n       '2024-04-10T20:00:00.000000000', '2024-04-10T21:00:00.000000000',\n       '2024-04-10T22:00:00.000000000', '2024-04-10T23:00:00.000000000',\n       '2024-04-11T00:00:00.000000000'], dtype='datetime64[ns]')\nCoordinates:\n  * time     (time) datetime64[ns] 2024-04-10 2024-04-10T01:00:00 ... 2024-04-11\nAttributes:\n    axis:           T\n    standard_name:  time\n"}],"visibility":"show","key":"euEsokk0v5"}],"visibility":"show","key":"J5xYaX6reT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Obtain data for specific variable and time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TdSffH6tbV"}],"identifier":"obtain-data-for-specific-variable-and-time","label":"Obtain data for specific variable and time","html_id":"obtain-data-for-specific-variable-and-time","implicit":true,"key":"hmi7FSO6c3"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Obtain surface pressure data from 10th of April to 11th of April.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hu3oiP1VMO"}],"key":"HpPXFpAGHH"}],"key":"F6mtDylCBl"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"africa_bbox = [-20,     # West\n                -40,    # South\n                60,     # East\n                40]     #North\n\nafrica_dt = xr.open_zarr(url)['sp'].sel(lon=slice(africa_bbox[0], \n                                            africa_bbox[2]), \n                                lat=slice(africa_bbox[3], \n                                            africa_bbox[1]),\n                                time=slice('20240410T000000', '20240411T000000')\n                                                         )\n\nprint(africa_dt.var)","visibility":"show","key":"GxuPRYbEKS"},{"type":"output","id":"9wJP671DfMFfxnHxB1j-v","data":[{"name":"stdout","output_type":"stream","text":"<bound method DataArrayAggregations.var of <xarray.DataArray 'sp' (time: 25, lat: 2276, lon: 2279)>\ndask.array<getitem, shape=(25, 2276, 2279), dtype=float32, chunksize=(25, 417, 837), chunktype=numpy.ndarray>\nCoordinates:\n  * lat      (lat) float64 39.99 39.95 39.92 39.88 ... -39.92 -39.95 -39.99\n  * lon      (lon) float64 -19.97 -19.94 -19.9 -19.87 ... 59.92 59.95 59.99\n  * time     (time) datetime64[ns] 2024-04-10 2024-04-10T01:00:00 ... 2024-04-11\nAttributes:\n    CDI_grid_num_LPE:  2560\n    CDI_grid_type:     gaussian\n    long_name:         Surface pressure\n    param:             0.3.0\n    standard_name:     surface_air_pressure\n    units:             Pa>\n"}],"visibility":"show","key":"Wfh5M1FO2E"}],"visibility":"show","key":"NW4xeVWk3e"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot map of surface pressure over Africa.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iTbjCnJDZF"}],"key":"MTES5cJMup"}],"key":"qg5a84xK16"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"lon = africa_dt['lon']\nlat = africa_dt['lat']\ntemperature = africa_dt[0] / 100    # Conversion to hectoPascals\n\nplt.figure(figsize=(10, 6))\nplt.pcolormesh(lon, lat, temperature, cmap='viridis')\nplt.colorbar(label='Surface Pressure (hPa)')\nplt.title('Surface pressure Map')\nplt.xlabel('Longitude')\nplt.ylabel('Latitude')","visibility":"show","key":"guMJAIhjGP"},{"type":"output","id":"x7ty1UaOQb6TIUQOwby49","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"57d5b6f621ee4b704d66932aa12f16a7","path":"/build/57d5b6f621ee4b704d66932aa12f16a7.png"},"text/plain":{"content":"<Figure size 1000x600 with 2 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"UxEwOGTjGn"}],"visibility":"show","key":"g5RpXUIY3j"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Time series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I1PNijc0hJ"}],"identifier":"time-series","label":"Time series","html_id":"time-series","implicit":true,"key":"NnvquCf5jh"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Verify if it is possible to create time series chart (for 96 hours) from DT output - air temperature over Nairobi.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"En800KScV7"}],"key":"jAqooGD0Rr"}],"key":"HobOEzAzJk"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"africa_bbox = [-20,     # West\n                -40,    # South\n                60,     # East\n                40]     #North\n\nafrica_dt = xr.open_zarr(url).sel(lon=slice(africa_bbox[0], \n                                            africa_bbox[2]), \n                                lat=slice(africa_bbox[3], \n                                            africa_bbox[1]),\n                                )\n                                                    ","visibility":"show","key":"soSJQiu7kh"},{"type":"output","id":"-ZmNpd8RZYkp2JckI7QEU","data":[],"visibility":"show","key":"BefbFpWNB5"}],"visibility":"show","key":"RBrRBq5RnJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a chart.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Moy2Vy2Nrn"}],"key":"zkDewx9dIi"}],"key":"QVhGeUdGF5"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define Nairobi coordinates\nnairobi_lat = -1.286389\nnairobi_lon = 36.817223\n\nlat = africa_dt['lat']\nlon = africa_dt['lon']\nnearest_lat_idx = np.abs(lat - nairobi_lat).argmin()\nnearest_lon_idx = np.abs(lon - nairobi_lon).argmin()\n\ntemperature_nairobi = africa_dt['2t'][:, :, nearest_lat_idx, nearest_lon_idx] - 273.15\ntime_values = africa_dt.time.values\n\nplt.figure(figsize=(10, 6))\nplt.plot(time_values, temperature_nairobi, marker='o', color='b')\nplt.title('Air Temperature Time Series for Nairobi')\nplt.xlabel('Time')\nplt.ylabel('Temperature (°C)')\nplt.grid(True)\nplt.show()\n","visibility":"show","key":"i8gp42xL6j"},{"type":"output","id":"CB4I2MXkVteNXk9meeBbd","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b61bf0f02adcece2bde436c11b668e6a","path":"/build/b61bf0f02adcece2bde436c11b668e6a.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"oMJhuARIPR"}],"visibility":"show","key":"kb6IIaG4jD"}],"key":"bkZr1uglm1"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"STACK service - Dask 101","url":"/stack-dask-101","group":"STACK"},"next":{"title":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","url":"/extremedt-datacube-xviewer","group":"STACK"}}},"domain":"http://localhost:3001"}