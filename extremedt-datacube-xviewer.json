{"version":2,"kind":"Notebook","sha256":"59f84c36c3329ec2c26136f3896fb5991bf3d2db55ea2138cab67a92cf11d77b","slug":"extremedt-datacube-xviewer","location":"/STACK/ExtremeDT-DataCube-xViewer.ipynb","dependencies":[],"frontmatter":{"title":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"xcube_env","language":"python"},"numbering":{"title":{"offset":2}},"thumbnail":"/build/13671a697054e05ccbcc105d371ab38b.png","exports":[{"format":"ipynb","filename":"ExtremeDT-DataCube-xViewer.ipynb","url":"/build/ExtremeDT-DataCube-x-2148e51e78cca18eb7715dc982b37887.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/build/13671a697054e05ccbcc105d371ab38b.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gsauScraP5","urlSource":"data:image/png;base64,iVBORw0KGg...5ErkJggg=="}],"key":"NLjYsEhZHt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sw3PiMMj1M"}],"key":"Y0ltGpVcwF"},{"type":"text","value":" EUMETSAT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JWLiASzzmi"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kljBCCbgBi"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copyright:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fQZEAHxEtO"}],"key":"wMZV0tbuDO"},{"type":"text","value":" 2024 EUMETSAT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VXXOoXXRXD"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tWkO8foiYj"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GA523oIhG5"}],"key":"FENCn4sOFD"},{"type":"text","value":" MIT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tMFt1SwaRD"}],"key":"qRcG0boCwY"}],"key":"es8d3Ww3Ji"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wW8r4OwawZ"}],"identifier":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","label":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","html_id":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","implicit":true,"key":"zQnLrjyVhB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"DISCLAIMER","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nbhCQ5Zur2"}],"key":"p8wnqKXtX7"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KUGWZcXSZJ"},{"type":"text","value":"In order to deal with the code provided within this notebook, it is required to run it on user environment (local one or virtual machine).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NgP32dBoVz"}],"key":"tz5wAKHpXK"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This notebook covers:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"s4fOLW31V0"}],"key":"J8JQmE9jhK"}],"key":"jcO5IeJjoJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"find available data cubes and their urls","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rKju8kqra5"}],"key":"Yhx7S9jqUn"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"filter data area of interest","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"agvtzJuDSy"}],"key":"DSkdAlsLMm"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"create interactive dashboard using xcube - xviewer","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XX0StDxbZy"}],"key":"GFuFPx3jWR"}],"key":"unApQpaR3v"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Presequites","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yAp5a6RwfC"}],"key":"n0GGDtPbPC"}],"key":"PGOW9zrc7w"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Xcube\nInstall xcube and create a new environment ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PyhDq35BrE"},{"type":"inlineCode","value":"mamba create --name xcube --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"WHNSky5Ywz"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"z8exIomiBm"},{"type":"text","value":"OR","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ltoU0EN443"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fgz3LU1ySe"},{"type":"text","value":"Install xcube in the current environment  ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Mh0VRMJT1u"},{"type":"inlineCode","value":"mamba install --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"gjTcTu13ZM"}],"key":"oXZKaBKkSh"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"BaOUn2DfGJ"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"T1bQA7vgny"},{"type":"text","value":"pip ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Dj3I2Bot2P"},{"type":"inlineCode","value":"pip install xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"PdcGftI8AM"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"EiAkFcwP2S"},{"type":"text","value":"OR","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"CDRAGfMhhG"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Q398OSGgpp"},{"type":"text","value":"conda  ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"imbtW9yIge"},{"type":"inlineCode","value":"conda install -c conda-forge xarray dask netCDF4 bottleneck","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"vCrEDoTdnB"}],"key":"gKlwScaQAS"}],"key":"j6O75Sb8Gx"}],"key":"It4L1MTKCN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepre your environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J3joHoYBTC"}],"identifier":"prepre-your-environment","label":"Prepre your environment","html_id":"prepre-your-environment","implicit":true,"key":"ynMW4Rw8VQ"}],"key":"bDgEGKa8l1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from xcube.webapi.viewer import Viewer\nimport xarray as xr\nimport requests","key":"MCNCtP0ZRV"},{"type":"output","id":"KuN5jRYr0nQc8Zo1Cs7F9","data":[],"key":"cb65tf8t6l"}],"key":"OR5c100Bwl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Connect with Extreme DT data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oeVKdmQpHA"}],"identifier":"connect-with-extreme-dt-data-cube","label":"Connect with Extreme DT data cube","html_id":"connect-with-extreme-dt-data-cube","implicit":true,"key":"XIymVcGhSv"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The data cube provides data:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uSO9vgYExK"}],"key":"TgySpxYhJJ"}],"key":"sK48QinZWN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Four variables","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"B1DRFFvSio"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2t - Air temperature at 2 meteres above grond [K]","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Vw4tz49u98"}],"key":"U3DVZUF62f"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2d - Dew point temperature at 2 meteres above grond [K]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Aa8UFrfJFK"}],"key":"ilLkYyCzs4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sp - Surface pressure [Pa]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rUlxSCijfD"}],"key":"aGlSzUls7T"}],"key":"JPRw7Slt5t"}],"key":"EHO8Rn47fC"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Forecast 2024.04.04-13 + 96 hours for each date","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uoB5r92pkP"}],"key":"afAMuxIMsf"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Hourly step","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EZLmrCtajM"}],"key":"qoYiBt5yoN"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"World","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UteAWPknpO"}],"key":"JH98kL0Jpq"}],"key":"vhkaAEQAmR"}],"key":"z9zTJGXoMU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select proper data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ac8WAXpnuG"}],"identifier":"select-proper-data-cube","label":"Select proper data cube","html_id":"select-proper-data-cube","implicit":true,"key":"eLpa8Olj0N"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data cubes on s3 bucket are stored under URL ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ITiDsMx2vy"},{"type":"link","url":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​s3​.central​.data​.destination​-earth​.eu​/swift​/v1​/dedl​_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BrFJu8Qa0k"}],"urlSource":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","key":"DzhHBFvnYa"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VNO4Xh4S7i"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hfXm4jCMOC"},{"type":"text","value":"Data cubes are stored in two directories:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ctFLRADSRj"}],"key":"ELfAlAK0ef"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"ExtremeDT - the newest one","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"c3g5KWHDTH"}],"key":"NJgenkw8A9"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"archive - from preicus days","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OmEWP4iYwb"}],"key":"mG0i15foXa"}],"key":"DeCk1k5WtM"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"File nameing convention:","key":"bPUv1qu6S1"}],"key":"kWrsuRhSrQ"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"R5MwTmzLhS"},{"type":"text","value":"dt_extreme_YYYYMMDD.zarr/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NcrlAafaRo"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"t6MVlxTbKl"},{"type":"text","value":"YYYYMMDD - is the date when forecast starts (step 0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"u5aSsElYPQ"}],"key":"aEtcrAzCSf"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"Results","key":"oG47XFBECJ"}],"key":"eyGOUKsEiJ"},{"type":"break","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KehHwhQZi2"},{"type":"text","value":"After exectution of code below, the list of urls linked to available cubes will be printed.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Km2K2FbCGh"}],"key":"BujjK9QGtF"}],"key":"cNxycuTynZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# URL to s3 where  ExtremeDT data cubes are stored\ndatacube_url = 'https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube'\nresponse = requests.get(datacube_url)\n\nif response.status_code == 200:\n    lines = response.text.splitlines()\n    zarr_items = [line for line in lines if line.endswith('.zarr') or line.endswith('.zarr/')]\n    if zarr_items:\n        for item in zarr_items:\n            print(item)\n            new_url = f\"{datacube_url}/{item}\"\n            print(\"New URL:\", new_url)\n    else:\n        print(\"No .zarr files or directories found.\")\nelse:\n    print(\"Failed to fetch contents. Status code:\", response.status_code)","key":"AswfUIGPrh"},{"type":"output","id":"Sn1p3Wu2RAUu2KsvvUd6Z","data":[{"name":"stdout","output_type":"stream","text":"ExtremeDT/dt_extreme_20240404.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240404.zarr/\nExtremeDT/dt_extreme_20240405.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240405.zarr/\nExtremeDT/dt_extreme_20240406.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240406.zarr/\nExtremeDT/dt_extreme_20240407.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240407.zarr/\nExtremeDT/dt_extreme_20240408.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240408.zarr/\nExtremeDT/dt_extreme_20240410.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240410.zarr/\nExtremeDT/dt_extreme_20240411.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240411.zarr/\nExtremeDT/dt_extreme_20240412.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240412.zarr/\nExtremeDT/dt_extreme_20240413.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240413.zarr/\narchive/dt_extreme_20240409.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/archive/dt_extreme_20240409.zarr/\n"}],"key":"c3w5g5BX1u"}],"key":"PxUmqE64zz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"url = 'https://s3.waw3-1.cloudferro.com/swift/v1/s5p_l3/ExtremeDT/dt_extreme_20240412.zarr/'","key":"uc1KuN4Ycd"},{"type":"output","id":"SdEmPlwgu3nlssyVjYtI1","data":[],"key":"cHz1tStWBh"}],"key":"t6MEalEf3g"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Area of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lBNCLY5532"}],"identifier":"area-of-interest","label":"Area of interest","html_id":"area-of-interest","implicit":true,"key":"nXiyzDReyR"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Upload data for selected area and verify what variables are provided. In this case uplaod data for Kenya. List of available variables should be returend.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uywvEySLSu"}],"key":"hr2LDj6nPy"}],"key":"ssWcZaW4Aa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_bbox = [33.501,   # West\n              -4.677,   # South\n              41.899,   # East\n              5.193]    # North\n\nkenya_dt = xr.open_zarr(url).sel(lon=slice(kenya_bbox[0], \n                                            kenya_bbox[2]), \n                                lat=slice(kenya_bbox[3], \n                                            kenya_bbox[1]),\n                                                         )\n\nlist(kenya_dt.keys())","key":"yXvDE439SZ"},{"type":"output","id":"GTETVWsMKq4olIQmgsYI5","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"['2d', '2t', 'sp']","content_type":"text/plain"}}}],"key":"PYtq47SRbE"}],"key":"v30frFL8NZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepare Data for visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bdth1hiphW"}],"identifier":"prepare-data-for-visualization","label":"Prepare Data for visualization","html_id":"prepare-data-for-visualization","implicit":true,"key":"QgsU1rz7NQ"}],"key":"KD6UsJ4jA9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert units","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zgQYN7V8wK"}],"identifier":"convert-units","label":"Convert units","html_id":"convert-units","implicit":true,"key":"KCshR4Uxks"}],"key":"AaoUDiGszl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['2d'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['sp'] /= 100       # Conversion to hectoPascals","key":"IojEqFGC4y"},{"type":"output","id":"ocvhvlDQ2GYYdicFZ9h3z","data":[],"key":"M3OJ9Ms6u8"}],"key":"PVroxDJYvo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'].attrs['units'] = '°C'\nkenya_dt['2d'].attrs['units'] = '°C'\nkenya_dt['sp'].attrs['units'] = 'hPa'","key":"nR6BGdX4x0"},{"type":"output","id":"lUsjfAQIghjKxfWHjb43k","data":[],"key":"VvW3QgsRoQ"}],"key":"ZgZrxfHG3h"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define style of visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P5YzsggUIf"}],"identifier":"define-style-of-visualization","label":"Define style of visualization","html_id":"define-style-of-visualization","implicit":true,"key":"guxKYD5crD"}],"key":"JbJRvK5Ji8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Error message starting with:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RxqIVnmQ1R"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YL6OJJdknn"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s13TlF86lp"}],"key":"E5icQIfmD6"}],"key":"OArJ7DoxO0"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P7EAGo3ATE"},{"type":"text","value":"could occur.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MmcHSEOtR7"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"evueJXPIjA"},{"type":"text","value":"It is normal and does not affect on proper functioning of xviewer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xbYhaEfdjQ"}],"key":"qS9THf6Xo6"}],"key":"WBteHy2Ggp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer = Viewer(server_config={\n    \"Styles\": [\n        {\n            \"Identifier\": \"dt_legend\",          # Style's name\n            \"ColorMappings\": {\n                \"2t\": {                         # Variable's name\n                    \"ValueRange\": [10, 30],     # Variable's values range\n                    \"ColorBar\": \"coolwarm\"      # colorbar\n                },\n                \"2d\": {                         # Variable's name\n                    \"ValueRange\": [0, 20],\n                    \"ColorBar\": \"coolwarm\",\n                },\n                'sp': {                         # Variable's name\n                    \"ValueRange\": [0, 1000],    # Variable's values range\n                    \"ColorBar\": \"viridis\"       # colorbar\n                },\n            }\n        },\n    ]\n})","key":"NmGOo6Iwoz"},{"type":"output","id":"-T9LyBmMVEIVORvI-RYx_","data":[{"name":"stderr","output_type":"stream","text":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/schema.py:464: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  dim_name: cube_chunks.get(dim_name, cube.dims[dim_name])\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\n404 GET /favicon.ico (127.0.0.1) 0.52ms\n404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 1.51ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception POST /timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='POST', uri='/timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 357, in post\n    await self._call_method('post', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/timeseries/routes.py\", line 122, in post\n    await self.response.finish(dict(result=result))\ntornado.iostream.StreamClosedError: Stream is closed\n"}],"key":"HguXTcy316"}],"key":"RWF4X1glx8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add style to the data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YGBvqN8FYr"}],"identifier":"add-style-to-the-data-cube","label":"Add style to the data cube","html_id":"add-style-to-the-data-cube","implicit":true,"key":"QHCl1wC3hd"}],"key":"EHtqP8BBwO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.add_dataset(kenya_dt, \n                   style=\"dt_legend\")","key":"uV9aEWnoAU"},{"type":"output","id":"M3N16J1GJQE-jfSlmmg4H","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"'ba3aaa64-1bdf-425d-8458-98b819c0e042'","content_type":"text/plain"}}}],"key":"Yhmupm4CbU"}],"key":"qVfgg62PD3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the dashboard","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uoAbYeBlSz"}],"identifier":"run-the-dashboard","label":"Run the dashboard","html_id":"run-the-dashboard","implicit":true,"key":"mT27J2E1Jj"}],"key":"wM9Z3yhNKK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.info()       # open dashboard in separate tab in browser\n#viewer.show()      # open dashboard in current Jupyter Notebook","key":"yfrpwzZJ1v"},{"type":"output","id":"10ZzzOnvaisC_lhqNuDRA","data":[{"name":"stdout","output_type":"stream","text":"Server: http://localhost:8002\nViewer: http://localhost:8002/viewer/?serverUrl=http://localhost:8002\n"}],"key":"lQ0s885jJk"}],"key":"PSPxFtgcWq"}],"key":"p1w1oGa3eV"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","url":"/extremedt-datacube","group":"STACK"},"next":{"title":"DestinE Data Lake - Stack Service Dask","url":"/dedl-stackservice-dask","group":"STACK"}}},"domain":"http://localhost:3001"}