{"version":2,"kind":"Notebook","sha256":"59f84c36c3329ec2c26136f3896fb5991bf3d2db55ea2138cab67a92cf11d77b","slug":"extremedt-datacube-xviewer","location":"/STACK/ExtremeDT-DataCube-xViewer.ipynb","dependencies":[],"frontmatter":{"title":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"xcube_env","language":"python"},"numbering":{"title":{"offset":2}},"thumbnail":"/build/13671a697054e05ccbcc105d371ab38b.png","exports":[{"format":"ipynb","filename":"ExtremeDT-DataCube-xViewer.ipynb","url":"/build/ExtremeDT-DataCube-x-acca95839d290980f47aa5229775c1a8.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/build/13671a697054e05ccbcc105d371ab38b.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y4iBfLzZwc","urlSource":"data:image/png;base64,iVBORw0KGg...5ErkJggg=="}],"key":"OXfPH3NCDH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EjU409jap1"}],"key":"CFmXhumjCH"},{"type":"text","value":" EUMETSAT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"irVXUdGdXj"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SdOdWkbquI"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copyright:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kfga6aUtic"}],"key":"Xy0udhWYtx"},{"type":"text","value":" 2024 EUMETSAT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UiE5q29dQ7"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PLD9SO5lFa"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lm0tao7FNr"}],"key":"y9Qs9ssJuI"},{"type":"text","value":" MIT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fsrzpVblEt"}],"key":"aTeykBat6R"}],"key":"SkRcViWOdN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D2pQRiztnS"}],"identifier":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","label":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","html_id":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","implicit":true,"key":"XI0Wxc3dO6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"DISCLAIMER","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M0nHTanNxD"}],"key":"LmzQUsQusF"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hdUeXYRuHI"},{"type":"text","value":"In order to deal with the code provided within this notebook, it is required to run it on user environment (local one or virtual machine).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xJd0K0ri4Q"}],"key":"qxrgVBwoWp"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This notebook covers:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Hgko1KVHut"}],"key":"etLOwsv0Uy"}],"key":"tTI2r45ev7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"find available data cubes and their urls","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"d5Sbpq085f"}],"key":"XGHRUy4XCy"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"filter data area of interest","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lVwSeQaL4h"}],"key":"QPBxwAQLLZ"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"create interactive dashboard using xcube - xviewer","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lk9nNfO00l"}],"key":"JkaGMtLibC"}],"key":"IG1KsF2ixs"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Presequites","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JQG2kTQiof"}],"key":"HnALoe1ib2"}],"key":"osGK0098Jn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Xcube\nInstall xcube and create a new environment ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"BztClgDp4S"},{"type":"inlineCode","value":"mamba create --name xcube --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"nRMeMWDkYM"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"uoyhennLxw"},{"type":"text","value":"OR","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"lzkeUuc8iw"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ddYCxWKm1D"},{"type":"text","value":"Install xcube in the current environment  ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"TFNJ2pQamR"},{"type":"inlineCode","value":"mamba install --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"hhcScENsk0"}],"key":"talx1gFLQB"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Uze1HLe2NQ"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"BuWK6rGrUn"},{"type":"text","value":"pip ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"l7eFQ69gf8"},{"type":"inlineCode","value":"pip install xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"HGmmiAHrSV"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"vYUc1Q4nfw"},{"type":"text","value":"OR","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"zDr1cGaknt"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"qsDigWChfR"},{"type":"text","value":"conda  ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"S9cegLbKLW"},{"type":"inlineCode","value":"conda install -c conda-forge xarray dask netCDF4 bottleneck","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"TFTth4BTQ5"}],"key":"iSVScVV8QL"}],"key":"qcqHalJcsX"}],"key":"sp6zAuBfDq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepre your environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VmgOrK2DZQ"}],"identifier":"prepre-your-environment","label":"Prepre your environment","html_id":"prepre-your-environment","implicit":true,"key":"KrnF4sZr9f"}],"key":"eQZNUuueYS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from xcube.webapi.viewer import Viewer\nimport xarray as xr\nimport requests","key":"m4RZp9ucE0"},{"type":"output","id":"saePiue_VViRcxUJ2PY-F","data":[],"key":"ulvbrFueXx"}],"key":"U8qL12uBya"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Connect with Extreme DT data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DP3p7RsU2D"}],"identifier":"connect-with-extreme-dt-data-cube","label":"Connect with Extreme DT data cube","html_id":"connect-with-extreme-dt-data-cube","implicit":true,"key":"FKRubZLRBu"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The data cube provides data:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HIymWtFFrF"}],"key":"JqxXmKpygo"}],"key":"xxMRfXfgHp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Four variables","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M1IHmtOIr3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2t - Air temperature at 2 meteres above grond [K]","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hhXeLl5tpi"}],"key":"FlNYKrP2NO"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2d - Dew point temperature at 2 meteres above grond [K]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BD77S4qAv0"}],"key":"NYUNnJY3wW"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sp - Surface pressure [Pa]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qV2QfQBWaF"}],"key":"aCX2OOvcv1"}],"key":"zf5HzcCRq1"}],"key":"zMWvgPqLV8"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Forecast 2024.04.04-13 + 96 hours for each date","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"WTJMDtQZY1"}],"key":"XXtDSHuoX8"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Hourly step","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nM4EJzhjde"}],"key":"r6xB9NXyo2"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"World","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OJyuQYTARO"}],"key":"ybQjNR4W7O"}],"key":"Xj5YIuQ03Z"}],"key":"RlcyoUzwvc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select proper data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T3mLNTCja7"}],"identifier":"select-proper-data-cube","label":"Select proper data cube","html_id":"select-proper-data-cube","implicit":true,"key":"EpVoUYGXfN"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data cubes on s3 bucket are stored under URL ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"a2YEkTEou6"},{"type":"link","url":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​s3​.central​.data​.destination​-earth​.eu​/swift​/v1​/dedl​_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nDYHSkPJ8c"}],"urlSource":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","key":"x5M0Q7Rmo3"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"iUDIfKxmG6"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sQdTRRrcR6"},{"type":"text","value":"Data cubes are stored in two directories:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nIOyep7Rev"}],"key":"E3ZnuOl4RG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"ExtremeDT - the newest one","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"C2SGFKIyic"}],"key":"AygKfcdaKQ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"archive - from preicus days","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FalTSNurFF"}],"key":"Mhn33JlLMX"}],"key":"D6iJp8ry4M"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"File nameing convention:","key":"OlJOOB2BNL"}],"key":"kVfGrsKgWY"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MZVhYfZ5yq"},{"type":"text","value":"dt_extreme_YYYYMMDD.zarr/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Nk9a7eDsbO"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Dn3D17Ov6x"},{"type":"text","value":"YYYYMMDD - is the date when forecast starts (step 0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aBpIM13DL9"}],"key":"YFMHttk5V3"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"Results","key":"rWOLDJ7fuh"}],"key":"eoyqmzgy8z"},{"type":"break","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WXkiuxz10V"},{"type":"text","value":"After exectution of code below, the list of urls linked to available cubes will be printed.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kv88BJc9ad"}],"key":"LTBJ1VJ3DQ"}],"key":"RINRBkyKH9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# URL to s3 where  ExtremeDT data cubes are stored\ndatacube_url = 'https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube'\nresponse = requests.get(datacube_url)\n\nif response.status_code == 200:\n    lines = response.text.splitlines()\n    zarr_items = [line for line in lines if line.endswith('.zarr') or line.endswith('.zarr/')]\n    if zarr_items:\n        for item in zarr_items:\n            print(item)\n            new_url = f\"{datacube_url}/{item}\"\n            print(\"New URL:\", new_url)\n    else:\n        print(\"No .zarr files or directories found.\")\nelse:\n    print(\"Failed to fetch contents. Status code:\", response.status_code)","key":"txmBhlsjMk"},{"type":"output","id":"Mr-kRM6fwGeb70wvN8C5g","data":[{"name":"stdout","output_type":"stream","text":"ExtremeDT/dt_extreme_20240404.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240404.zarr/\nExtremeDT/dt_extreme_20240405.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240405.zarr/\nExtremeDT/dt_extreme_20240406.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240406.zarr/\nExtremeDT/dt_extreme_20240407.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240407.zarr/\nExtremeDT/dt_extreme_20240408.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240408.zarr/\nExtremeDT/dt_extreme_20240410.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240410.zarr/\nExtremeDT/dt_extreme_20240411.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240411.zarr/\nExtremeDT/dt_extreme_20240412.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240412.zarr/\nExtremeDT/dt_extreme_20240413.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240413.zarr/\narchive/dt_extreme_20240409.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/archive/dt_extreme_20240409.zarr/\n"}],"key":"lXJBfs3Y2Y"}],"key":"Oz0EGA60YL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"url = 'https://s3.waw3-1.cloudferro.com/swift/v1/s5p_l3/ExtremeDT/dt_extreme_20240412.zarr/'","key":"OTpcAt82ff"},{"type":"output","id":"VUKsw_HAl_iQB-PAs1waI","data":[],"key":"GhHBKnFB6t"}],"key":"Pz05vmyyDX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Area of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eUNfXdpLrq"}],"identifier":"area-of-interest","label":"Area of interest","html_id":"area-of-interest","implicit":true,"key":"HjfLqtXFKV"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Upload data for selected area and verify what variables are provided. In this case uplaod data for Kenya. List of available variables should be returend.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qd73cGyFHy"}],"key":"cWGPv6S7Ji"}],"key":"HCNbggIeJ1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_bbox = [33.501,   # West\n              -4.677,   # South\n              41.899,   # East\n              5.193]    # North\n\nkenya_dt = xr.open_zarr(url).sel(lon=slice(kenya_bbox[0], \n                                            kenya_bbox[2]), \n                                lat=slice(kenya_bbox[3], \n                                            kenya_bbox[1]),\n                                                         )\n\nlist(kenya_dt.keys())","key":"tZVi2dSH0e"},{"type":"output","id":"QW9gO2TbufF7v9za4ea79","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"['2d', '2t', 'sp']","content_type":"text/plain"}}}],"key":"ywmB28l70z"}],"key":"gdYhHumf5g"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepare Data for visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v8pPSup0Ao"}],"identifier":"prepare-data-for-visualization","label":"Prepare Data for visualization","html_id":"prepare-data-for-visualization","implicit":true,"key":"xqPSuWVjLG"}],"key":"KvUTLi31yx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert units","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XyqVJ2Zc2Y"}],"identifier":"convert-units","label":"Convert units","html_id":"convert-units","implicit":true,"key":"Pw90LyGFBH"}],"key":"H6VLEsRri5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['2d'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['sp'] /= 100       # Conversion to hectoPascals","key":"c8aMvWTSQo"},{"type":"output","id":"kPOs-HhYf-2LU2f--8szG","data":[],"key":"WavbXOSJUd"}],"key":"EkvybaIStC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'].attrs['units'] = '°C'\nkenya_dt['2d'].attrs['units'] = '°C'\nkenya_dt['sp'].attrs['units'] = 'hPa'","key":"lALCEAWNwr"},{"type":"output","id":"UYlNSkR0Kz8YXy_izj9c2","data":[],"key":"Pg1OMtdWFp"}],"key":"Ax6lhujTgU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define style of visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fwbW1tNHtn"}],"identifier":"define-style-of-visualization","label":"Define style of visualization","html_id":"define-style-of-visualization","implicit":true,"key":"WbY0qkpJwp"}],"key":"b3EnkCQce1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Error message starting with:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YNE4eHBe8H"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Emy8KBBRBd"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"acy7yqkXTE"}],"key":"H1N2pCPJ2A"}],"key":"nPyvkoSZ7D"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AHcAvwEvpV"},{"type":"text","value":"could occur.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mkNtsvW18T"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dSkElORXZ2"},{"type":"text","value":"It is normal and does not affect on proper functioning of xviewer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mmE79XGtDa"}],"key":"I1oxHyINGB"}],"key":"T92pmwkbGN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer = Viewer(server_config={\n    \"Styles\": [\n        {\n            \"Identifier\": \"dt_legend\",          # Style's name\n            \"ColorMappings\": {\n                \"2t\": {                         # Variable's name\n                    \"ValueRange\": [10, 30],     # Variable's values range\n                    \"ColorBar\": \"coolwarm\"      # colorbar\n                },\n                \"2d\": {                         # Variable's name\n                    \"ValueRange\": [0, 20],\n                    \"ColorBar\": \"coolwarm\",\n                },\n                'sp': {                         # Variable's name\n                    \"ValueRange\": [0, 1000],    # Variable's values range\n                    \"ColorBar\": \"viridis\"       # colorbar\n                },\n            }\n        },\n    ]\n})","key":"ZOVv6jmtca"},{"type":"output","id":"eIwvWDuA-qHIBr47vVP7p","data":[{"name":"stderr","output_type":"stream","text":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/schema.py:464: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  dim_name: cube_chunks.get(dim_name, cube.dims[dim_name])\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\n404 GET /favicon.ico (127.0.0.1) 0.52ms\n404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 1.51ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception POST /timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='POST', uri='/timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 357, in post\n    await self._call_method('post', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/timeseries/routes.py\", line 122, in post\n    await self.response.finish(dict(result=result))\ntornado.iostream.StreamClosedError: Stream is closed\n"}],"key":"EGFKqsQYYd"}],"key":"Cf7YpaKre5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add style to the data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rL8o2OJqMF"}],"identifier":"add-style-to-the-data-cube","label":"Add style to the data cube","html_id":"add-style-to-the-data-cube","implicit":true,"key":"qXaibZYaof"}],"key":"vLUhHusrmB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.add_dataset(kenya_dt, \n                   style=\"dt_legend\")","key":"jSi7ZfvJia"},{"type":"output","id":"u3qTZpUCAumLNw89EMjGo","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"'ba3aaa64-1bdf-425d-8458-98b819c0e042'","content_type":"text/plain"}}}],"key":"sJiNxIudu1"}],"key":"BwZxcWTau7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the dashboard","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gv49ZiGw4K"}],"identifier":"run-the-dashboard","label":"Run the dashboard","html_id":"run-the-dashboard","implicit":true,"key":"x3SYp6zdvQ"}],"key":"rb20Uk0MkF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.info()       # open dashboard in separate tab in browser\n#viewer.show()      # open dashboard in current Jupyter Notebook","key":"WPmEvtFDon"},{"type":"output","id":"CRG0EADVF9OB4VTdN9dIX","data":[{"name":"stdout","output_type":"stream","text":"Server: http://localhost:8002\nViewer: http://localhost:8002/viewer/?serverUrl=http://localhost:8002\n"}],"key":"I5026NgOa9"}],"key":"y8HfbQeKUi"}],"key":"Gecu11KVaC"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","url":"/extremedt-datacube","group":"STACK"},"next":{"title":"DestinE Data Lake - Stack Service Dask","url":"/dedl-stackservice-dask","group":"STACK"}}},"domain":"http://localhost:3001"}