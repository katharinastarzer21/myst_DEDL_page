{"version":2,"kind":"Notebook","sha256":"59f84c36c3329ec2c26136f3896fb5991bf3d2db55ea2138cab67a92cf11d77b","slug":"extremedt-datacube-xviewer","location":"/STACK/ExtremeDT-DataCube-xViewer.ipynb","dependencies":[],"frontmatter":{"title":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"xcube_env","language":"python"},"numbering":{"title":{"offset":2}},"thumbnail":"/build/13671a697054e05ccbcc105d371ab38b.png","exports":[{"format":"ipynb","filename":"ExtremeDT-DataCube-xViewer.ipynb","url":"/build/ExtremeDT-DataCube-x-8a5433a5e5e5e0bed3e92f2353ab0432.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/build/13671a697054e05ccbcc105d371ab38b.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nUVwpKxFpk","urlSource":"data:image/png;base64,iVBORw0KGg...5ErkJggg=="}],"key":"rSJ9vRPq6H"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZSCFxWcqrU"}],"key":"BHsOcfDqPs"},{"type":"text","value":" EUMETSAT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p2McKlz7PA"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tx12lLXIZE"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copyright:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pe0YLeNSvH"}],"key":"CEdhKRsTRz"},{"type":"text","value":" 2024 EUMETSAT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RjeEJyLzcz"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rvuPVvmOXR"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sKJHeYGKjy"}],"key":"PHD4f79pJU"},{"type":"text","value":" MIT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oi6cePEwNk"}],"key":"EW45xtMBXE"}],"key":"f56oiAZYNz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s2IbCfplO0"}],"identifier":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","label":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","html_id":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","implicit":true,"key":"qqoxue15L1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"DISCLAIMER","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NcAbd7qzAg"}],"key":"C5cU7NjMEo"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X9GlVj9AES"},{"type":"text","value":"In order to deal with the code provided within this notebook, it is required to run it on user environment (local one or virtual machine).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OJF5wjvNpg"}],"key":"rzzC5NNav4"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This notebook covers:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"z11lEzmk47"}],"key":"b6WYREcAFg"}],"key":"kSYOuePKJZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"find available data cubes and their urls","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SAP16XDGfE"}],"key":"WA5Jdl78Ae"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"filter data area of interest","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Qts3CAeVvk"}],"key":"QF9s47WsQ5"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"create interactive dashboard using xcube - xviewer","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qgb29UNbkm"}],"key":"r1839nzUOA"}],"key":"G9oE3ujeg0"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Presequites","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PUrANaaEaA"}],"key":"Xo295RSL0X"}],"key":"flCo2THYwI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Xcube\nInstall xcube and create a new environment ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FMVIv8LI59"},{"type":"inlineCode","value":"mamba create --name xcube --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"CEH8OjxsNe"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"uiAfxmPMoK"},{"type":"text","value":"OR","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tblUEK8y0e"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"sCdkeFsKjM"},{"type":"text","value":"Install xcube in the current environment  ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"AUuDBfDyA5"},{"type":"inlineCode","value":"mamba install --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"wF4kioVEai"}],"key":"metteyI2Y2"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"YrMPP9bTpJ"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"y3b0w4ZyWl"},{"type":"text","value":"pip ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pYYWFv9Cvp"},{"type":"inlineCode","value":"pip install xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"p2T24OUh3V"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"bfxDIzGeTF"},{"type":"text","value":"OR","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Aw3zxyt6tJ"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"muFHWUn2Ib"},{"type":"text","value":"conda  ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"UiaY0yuTlh"},{"type":"inlineCode","value":"conda install -c conda-forge xarray dask netCDF4 bottleneck","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"RWJKutSfEA"}],"key":"dTxaFlmQAa"}],"key":"A7ekGGB5Al"}],"key":"HHP40RSuZj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepre your environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cvpr8cwE8p"}],"identifier":"prepre-your-environment","label":"Prepre your environment","html_id":"prepre-your-environment","implicit":true,"key":"UdDgvaF06j"}],"key":"sW4TQwuEXt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from xcube.webapi.viewer import Viewer\nimport xarray as xr\nimport requests","key":"G183DSPtkz"},{"type":"output","id":"wmthmbuu3jDBPznfkOU-J","data":[],"key":"AnOCJ4CcBO"}],"key":"Atv97K9gDR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Connect with Extreme DT data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X7sx2RZ1AW"}],"identifier":"connect-with-extreme-dt-data-cube","label":"Connect with Extreme DT data cube","html_id":"connect-with-extreme-dt-data-cube","implicit":true,"key":"CYoDk9QMgg"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The data cube provides data:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"upjID1zZ0n"}],"key":"rJjj3HQvrI"}],"key":"t6FEU8P3ui"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Four variables","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FUnaazOtIn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2t - Air temperature at 2 meteres above grond [K]","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jBQ8Ii1ZnP"}],"key":"jizh6wpNkd"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2d - Dew point temperature at 2 meteres above grond [K]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bygunHwNUB"}],"key":"eozKR24TJh"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sp - Surface pressure [Pa]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jmfPsO6KfU"}],"key":"Sdw3Fc2JRu"}],"key":"l4YxhqKjjB"}],"key":"X3AxIFUTG5"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Forecast 2024.04.04-13 + 96 hours for each date","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IMeSIBg2dr"}],"key":"FFvIapdNAW"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Hourly step","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Jz9Gy86KBO"}],"key":"i5kcCzR7gs"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"World","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JSDqXPohLX"}],"key":"TcVFCwUunL"}],"key":"Q2VaOAGl60"}],"key":"MpW4liwfL8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select proper data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ldSNfXTrZn"}],"identifier":"select-proper-data-cube","label":"Select proper data cube","html_id":"select-proper-data-cube","implicit":true,"key":"KXflOxAx6s"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data cubes on s3 bucket are stored under URL ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ur2JTyz2iL"},{"type":"link","url":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​s3​.central​.data​.destination​-earth​.eu​/swift​/v1​/dedl​_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"z0gN0LytUI"}],"urlSource":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","key":"BH7Ixvi4Ux"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wjVBdLrUQi"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hVJDhU3wQ2"},{"type":"text","value":"Data cubes are stored in two directories:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OmXRuejeY5"}],"key":"tJawVwqaOx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"ExtremeDT - the newest one","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vuDmbGeXCW"}],"key":"JIwmCFvShn"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"archive - from preicus days","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BhrPURlmgG"}],"key":"KLDvEaiCca"}],"key":"e1rDoGoyXL"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"File nameing convention:","key":"oVD6eGTAbX"}],"key":"P3pI4WgqvJ"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jPihu0k0L9"},{"type":"text","value":"dt_extreme_YYYYMMDD.zarr/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uGfQqbqV2v"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RYp2PT4hXf"},{"type":"text","value":"YYYYMMDD - is the date when forecast starts (step 0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pDh8h9xi1M"}],"key":"V7ndsYN7DW"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"Results","key":"gwn48P6JLw"}],"key":"QoiAwTJc73"},{"type":"break","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FUK8RTRU5b"},{"type":"text","value":"After exectution of code below, the list of urls linked to available cubes will be printed.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rzGIdqfkpQ"}],"key":"om0OS42pmO"}],"key":"j090PymSLU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# URL to s3 where  ExtremeDT data cubes are stored\ndatacube_url = 'https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube'\nresponse = requests.get(datacube_url)\n\nif response.status_code == 200:\n    lines = response.text.splitlines()\n    zarr_items = [line for line in lines if line.endswith('.zarr') or line.endswith('.zarr/')]\n    if zarr_items:\n        for item in zarr_items:\n            print(item)\n            new_url = f\"{datacube_url}/{item}\"\n            print(\"New URL:\", new_url)\n    else:\n        print(\"No .zarr files or directories found.\")\nelse:\n    print(\"Failed to fetch contents. Status code:\", response.status_code)","key":"P0omPgBEem"},{"type":"output","id":"JEuomuInSJgxSDy-DqK_V","data":[{"name":"stdout","output_type":"stream","text":"ExtremeDT/dt_extreme_20240404.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240404.zarr/\nExtremeDT/dt_extreme_20240405.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240405.zarr/\nExtremeDT/dt_extreme_20240406.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240406.zarr/\nExtremeDT/dt_extreme_20240407.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240407.zarr/\nExtremeDT/dt_extreme_20240408.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240408.zarr/\nExtremeDT/dt_extreme_20240410.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240410.zarr/\nExtremeDT/dt_extreme_20240411.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240411.zarr/\nExtremeDT/dt_extreme_20240412.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240412.zarr/\nExtremeDT/dt_extreme_20240413.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240413.zarr/\narchive/dt_extreme_20240409.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/archive/dt_extreme_20240409.zarr/\n"}],"key":"KrhFJtSVeD"}],"key":"N0B4pWMzlj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"url = 'https://s3.waw3-1.cloudferro.com/swift/v1/s5p_l3/ExtremeDT/dt_extreme_20240412.zarr/'","key":"I22irzbIZC"},{"type":"output","id":"KbOi57wfE9_TD--XtoBra","data":[],"key":"jC3HsEyN5S"}],"key":"pzYQJPLSPu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Area of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZuBFcKUc5J"}],"identifier":"area-of-interest","label":"Area of interest","html_id":"area-of-interest","implicit":true,"key":"FNpHkLV89d"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Upload data for selected area and verify what variables are provided. In this case uplaod data for Kenya. List of available variables should be returend.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RChdZu39Ik"}],"key":"rEafubPpo6"}],"key":"jVABtT9mmZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_bbox = [33.501,   # West\n              -4.677,   # South\n              41.899,   # East\n              5.193]    # North\n\nkenya_dt = xr.open_zarr(url).sel(lon=slice(kenya_bbox[0], \n                                            kenya_bbox[2]), \n                                lat=slice(kenya_bbox[3], \n                                            kenya_bbox[1]),\n                                                         )\n\nlist(kenya_dt.keys())","key":"IvI66ExqOf"},{"type":"output","id":"Y5p3rzB9j-BjoAGu2gGw8","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"['2d', '2t', 'sp']","content_type":"text/plain"}}}],"key":"PoGJba5Mip"}],"key":"VvkaIEIJn6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepare Data for visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o78b7DZY4b"}],"identifier":"prepare-data-for-visualization","label":"Prepare Data for visualization","html_id":"prepare-data-for-visualization","implicit":true,"key":"BDFhsGWCc4"}],"key":"Jkmr09ctZ4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert units","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vUNlAIwcnQ"}],"identifier":"convert-units","label":"Convert units","html_id":"convert-units","implicit":true,"key":"eXgZE2WFxJ"}],"key":"svNStWaPOJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['2d'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['sp'] /= 100       # Conversion to hectoPascals","key":"hmZhMYWVFC"},{"type":"output","id":"MsV7smD4FWlOBUkwaP_KI","data":[],"key":"lxU7zsCTAP"}],"key":"Fi3i29rG4Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'].attrs['units'] = '°C'\nkenya_dt['2d'].attrs['units'] = '°C'\nkenya_dt['sp'].attrs['units'] = 'hPa'","key":"lbHLo96SYA"},{"type":"output","id":"rsbje6Kux6VMZgWR4QHfI","data":[],"key":"DRZbRYT1sl"}],"key":"qxDLtC8nkm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define style of visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wwbemdXndU"}],"identifier":"define-style-of-visualization","label":"Define style of visualization","html_id":"define-style-of-visualization","implicit":true,"key":"LcYh9zs0h5"}],"key":"zdBTxDWmN3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Error message starting with:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e5a759DsTP"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qIRulIRMA6"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ryGHgp1rIv"}],"key":"AjuRi0gk3D"}],"key":"ca0CkBS0EX"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eu3PmZjFhr"},{"type":"text","value":"could occur.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wjU798roHr"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bL8PnUz7Id"},{"type":"text","value":"It is normal and does not affect on proper functioning of xviewer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ov1UM3qrIp"}],"key":"a7aS9crfHr"}],"key":"bmJX7Ppw0O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer = Viewer(server_config={\n    \"Styles\": [\n        {\n            \"Identifier\": \"dt_legend\",          # Style's name\n            \"ColorMappings\": {\n                \"2t\": {                         # Variable's name\n                    \"ValueRange\": [10, 30],     # Variable's values range\n                    \"ColorBar\": \"coolwarm\"      # colorbar\n                },\n                \"2d\": {                         # Variable's name\n                    \"ValueRange\": [0, 20],\n                    \"ColorBar\": \"coolwarm\",\n                },\n                'sp': {                         # Variable's name\n                    \"ValueRange\": [0, 1000],    # Variable's values range\n                    \"ColorBar\": \"viridis\"       # colorbar\n                },\n            }\n        },\n    ]\n})","key":"rOFw7hrw7v"},{"type":"output","id":"T5I0VZ74DO1l09Y2VLnql","data":[{"name":"stderr","output_type":"stream","text":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/schema.py:464: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  dim_name: cube_chunks.get(dim_name, cube.dims[dim_name])\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\n404 GET /favicon.ico (127.0.0.1) 0.52ms\n404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 1.51ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception POST /timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='POST', uri='/timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 357, in post\n    await self._call_method('post', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/timeseries/routes.py\", line 122, in post\n    await self.response.finish(dict(result=result))\ntornado.iostream.StreamClosedError: Stream is closed\n"}],"key":"Lo80sCsZbd"}],"key":"d1z5E5MiKz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add style to the data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BxMesYSatw"}],"identifier":"add-style-to-the-data-cube","label":"Add style to the data cube","html_id":"add-style-to-the-data-cube","implicit":true,"key":"I6CmKUJfmj"}],"key":"VFXSSewCPd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.add_dataset(kenya_dt, \n                   style=\"dt_legend\")","key":"OzW5gns6yZ"},{"type":"output","id":"lod8ZzuKTlUoJPpuQ9Kbk","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"'ba3aaa64-1bdf-425d-8458-98b819c0e042'","content_type":"text/plain"}}}],"key":"fO2M2E4iyl"}],"key":"nL263VKXyr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the dashboard","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f0dsUuchD6"}],"identifier":"run-the-dashboard","label":"Run the dashboard","html_id":"run-the-dashboard","implicit":true,"key":"FWptOZUYxm"}],"key":"Xiu9RXb8ri"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.info()       # open dashboard in separate tab in browser\n#viewer.show()      # open dashboard in current Jupyter Notebook","key":"hEKGAOCbaE"},{"type":"output","id":"P_jrB8n37agWV9HAXYtcL","data":[{"name":"stdout","output_type":"stream","text":"Server: http://localhost:8002\nViewer: http://localhost:8002/viewer/?serverUrl=http://localhost:8002\n"}],"key":"o16s7J3uh6"}],"key":"LGY3hIP2qO"}],"key":"IJUzQbItZb"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","url":"/extremedt-datacube","group":"STACK"},"next":{"title":"DestinE Data Lake - Stack Service Dask","url":"/dedl-stackservice-dask","group":"STACK"}}},"domain":"http://localhost:3001"}