{"version":2,"kind":"Notebook","sha256":"af1af1743f5c9b0501cd04dc536e7303f3f47972e110c129da6370ed31d1cd18","slug":"stack-python-client-dask","location":"/STACK/STACK-Python-Client-Dask.ipynb","dependencies":[],"frontmatter":{"title":"STACK service - Python Client Dask","content_includes_title":true,"kernelspec":{"name":"python_dedl","display_name":"Python DEDL","language":"python"},"numbering":{"title":{"offset":2}},"thumbnail":"/b27bd30f978ddf0848f3ea0942070886.jpeg","exports":[{"format":"ipynb","filename":"STACK-Python-Client-Dask.ipynb","url":"/STACK-Python-Client--56b2b7cba172b6c65b5626e548fecf31.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/b27bd30f978ddf0848f3ea0942070886.jpeg","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RSwibEUwQx","urlSource":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/img/DestinE-banner.jpg?raw=true"}],"key":"C4WJzUvw6a"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mxYVY7keW2"}],"key":"anYMa2ot8N"},{"type":"text","value":": MIT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V5FY6txFT4"},{"type":"break","key":"BafBKijJmU"}],"key":"TAlrUic2YU"},{"type":"image","url":"/2b00998ddd74a039529882b6d26ca076.svg","alt":"Dask logo","key":"v91MdCltHE","urlSource":"https://docs.dask.org/en/latest/_images/dask_horizontal.svg"},{"type":"heading","depth":1,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"STACK service - Python Client Dask","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FVK5Dgozx0"}],"identifier":"stack-service-python-client-dask","label":"STACK service - Python Client Dask","html_id":"stack-service-python-client-dask","implicit":true,"key":"WWB7foqP3L"},{"type":"heading","depth":1,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Multi-cloud processing with Dask","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"fZPFGzTmoe"}],"identifier":"multi-cloud-processing-with-dask","label":"Multi-cloud processing with Dask","html_id":"multi-cloud-processing-with-dask","implicit":true,"key":"jXkTqJ66nV"},{"type":"div","class":"alert-info","children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"Overview","key":"iscrERFYK9"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"I2MLGQ9dGl"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Content","key":"p4DczIAXZC"}],"identifier":"content","label":"Content","html_id":"content","implicit":true,"key":"Jwwre8TphH"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"DestinE Data Lake (DEDL) Stack Client","key":"uudlRz1YXy"}],"key":"cSzhj3PrA7"}],"key":"dCps8VUQFV"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Making use of clients context manager","key":"hL8Klvkf4F"}],"key":"j1G1ZkggaI"}],"key":"Zc5TGsVD6p"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use Case: Pakistan Flood 2022","key":"Ejb4K0zzui"}],"key":"pFlhTtPEzn"}],"key":"re1ByPjRjQ"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Duration: 15 min.","key":"OVyrfkzZ6w"}],"identifier":"duration-15-min","label":"Duration: 15 min.","html_id":"duration-15-min","implicit":true,"key":"u7zPvHnVgb"}],"key":"vKrFBZ41x6"},{"type":"break","key":"I5GZQLADVq"},{"type":"div","class":"alert-warning","children":[{"type":"text","value":"Please make sure Python DEDL kernel is used.","key":"nmq14K41ga"}],"key":"YWoTt818FL"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"DestinE Data Lake utilises a deployment of ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ncFV8XwnnN"},{"type":"link","url":"https://gateway.dask.org/","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Dask Gateway","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"QqRtUXhj1l"}],"urlSource":"https://gateway.dask.org/","key":"ktiSr5rruM"},{"type":"text","value":" on each location (bridge) in the data lake. Dask Gateway provides a secure, multi-tenant server for managing Dask clusters. It allows users to launch and use Dask clusters in a shared, centrally managed cluster environment, without requiring users to have direct access to the underlying cluster backend (e.g. Kubernetes, Hadoop/YARN, HPC Job queues, etc…).","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"I7OwNYx47p"}],"key":"bW0WPUAJ7H"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Dask Gateway exposes a REST API to spawn clusters on demand. The overall architecture of Dask Gateway is depicted hereafter.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"f6H1pzAJ9T"}],"key":"wuQVJcZbxJ"},{"type":"image","url":"/01f61b2ebec9f77ff63c7f40d6a20edc.png","key":"wAQ3PBO7Y8","urlSource":"https://github.com/destination-earth/DestinE-DataLake-Lab/blob/main/STACK/img/DEDL_Dask_multicloud.png?raw=true"},{"type":"heading","depth":2,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"DEDL Dask Gateway","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"MEgwjiLDA8"}],"identifier":"dedl-dask-gateway","label":"DEDL Dask Gateway","html_id":"dedl-dask-gateway","implicit":true,"key":"gVpusmYMx4"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Central Site","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"n4qP6I2Tpo"}],"key":"idbaKiIkE0"}],"key":"y0cQaH2fkA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":30,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"address: ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"FYG24WHa7v"},{"type":"link","url":"http://dask.central.data.destination-earth.eu","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"http://​dask​.central​.data​.destination​-earth​.eu","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"obC6rJQOUw"}],"urlSource":"http://dask.central.data.destination-earth.eu","key":"B9TZQK8fU1"}],"key":"hmJegIdBHc"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"proxy_address: tcp://dask.central.data.destination-earth.eu:80","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"AHWVEthkq0"}],"key":"RDnOy3WBFg"}],"key":"nzxkxWyHrb"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"LUMI Bridge","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"s69xkqRP9M"}],"key":"qVWV0XcndO"}],"key":"oiDrmOx2sj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":34,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"address: ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"XRvilzfBQc"},{"type":"link","url":"http://dask.lumi.data.destination-earth.eu","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"http://​dask​.lumi​.data​.destination​-earth​.eu","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"szrDrK5peS"}],"urlSource":"http://dask.lumi.data.destination-earth.eu","key":"RU8ibpHcnZ"}],"key":"uuKiKRADm3"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"proxy_address: tcp://dask.lumi.data.destination-earth.eu:80","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"LlpLk6LNSP"}],"key":"jivjvQiBie"}],"key":"DkKW0YMsh3"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Only authenticated access is granted to the DEDL STACK service Dask, therefore a helper class to authenticate a user against the DESP identity management system is implemented. The users password is directly handed over to the request object and is not permanently stored.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"CRQaHYQKvi"}],"key":"dUGw63fzL4"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"In the following, please enter your DESP username and password. Again, the password will only be saved for the duration of this user session and will be remove as soon as the notebook/kernel is closed.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"cT9sWS9CVh"}],"key":"k4TC8c0dgg"}],"key":"jwj7Gz52HF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from dask_gateway.auth import GatewayAuth\nfrom getpass import getpass\nfrom destinelab import AuthHandler as DESP_AuthHandler\n\nclass DESPAuth(GatewayAuth):\n    def __init__(self, username: str):\n        self.auth_handler = DESP_AuthHandler(username, getpass(\"Please input your DESP password: \"))\n        self.access_token = self.auth_handler.get_token()\n    \n    def pre_request(self, _):\n        headers = {\"Authorization\": \"Bearer \" + self.access_token}\n        return headers, None","key":"COQGu5x5Sw"},{"type":"output","id":"J75E09gs5RKKBshUB_sSC","data":[],"key":"ZO529FWTHE"}],"key":"a7L8ODz7xl"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from rich.prompt import Prompt\nmyAuth = DESPAuth(username=Prompt.ask(prompt=\"Username\"))","visibility":"show","key":"rTA3bSaXcD"},{"type":"output","id":"OnMPep-q3ESn_XnFmYFWX","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Username: </pre>\n","content_type":"text/html"},"text/plain":{"content":"Username: ","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":" christoph.reimer\nPlease input your DESP password:  ········\n"},{"name":"stdout","output_type":"stream","text":"Response code: 200\n"}],"visibility":"show","key":"r4Jl86WMIP"}],"visibility":"show","key":"EPQuAu4tjf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DestinE Data Lake (DEDL) Stack Client","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QgRAOiL2lh"}],"identifier":"destine-data-lake-dedl-stack-client","label":"DestinE Data Lake (DEDL) Stack Client","html_id":"destine-data-lake-dedl-stack-client","implicit":true,"key":"kqklZH9Kuq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h8M0lwnlCm"},{"type":"link","url":"https://github.com/destination-earth/DestinE_EUMETSAT_DEDL_Stack_Client","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"DEDL Stack Client is a Python","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uFXAzGrhph"}],"urlSource":"https://github.com/destination-earth/DestinE_EUMETSAT_DEDL_Stack_Client","error":true,"key":"RAvgn75vOI"},{"type":"text","value":" library to facilitate the use of Stack Service Dask. The main objective is to provide an abstraction layer to interact with the various clusters on each DEDL bridge. Computations can be directed to the different Dask clusters by making use of a context manager as given in the following.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"A0mFGipzms"}],"key":"B45pC8P8Uj"}],"key":"tbcTZsZKR7"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from dedl_stack_client.dask import DaskMultiCluster\n\nmyDEDLClusters = DaskMultiCluster(auth=myAuth)\nmyDEDLClusters.new_cluster()","visibility":"show","key":"vZjJ9L13ZF"},{"type":"output","id":"_DG4hWPZytF-Eqi7sqNsw","data":[{"name":"stdout","output_type":"stream","text":"Create new cluster for Central Site\nCreate new cluster for LUMI Bridge\n"}],"visibility":"show","key":"iIasUQY2uD"}],"visibility":"show","key":"xlD8SuIEQX"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"myDEDLClusters.get_cluster_url()","visibility":"show","key":"gNDqQzt1mA"},{"type":"output","id":"toAdI9bli9f56CVg-84eS","data":[{"name":"stdout","output_type":"stream","text":"http://dask.central.data.destination-earth.eu/clusters/dask-gateway.203d0155443945c986a35b0488db7ebb/status\nhttp://dask.lumi.data.destination-earth.eu/clusters/dask-gateway.9010455c0c8a44df9a52e15003252889/status\n"}],"visibility":"show","key":"rF0mTNczcu"}],"visibility":"show","key":"qLGIACgR0S"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We can again showcase the execution of standard Python functions on the remote clusters.\nIn the following we will make use of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lS97wdTLBT"},{"type":"inlineCode","value":"dask.futures","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"coFNAql1Zi"},{"type":"text","value":", non-blocking distributed calculations, utilising the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YsEi6sK6wg"},{"type":"inlineCode","value":"map()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JXTwrAGBcG"},{"type":"text","value":" method for task distribution. Detailed information about ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bE0jGT5TXk"},{"type":"inlineCode","value":"dask.futures","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"joRdOovmq8"},{"type":"text","value":" can be found on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z6vXT4pJeN"},{"type":"link","url":"https://docs.dask.org/en/stable/futures.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dask documention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zA12LPWd3X"}],"urlSource":"https://docs.dask.org/en/stable/futures.html","key":"yN704J8yBU"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mj6E3onECl"}],"key":"UvCHNhJfot"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This approach allows for embarrassingly parallel task scheduling, which is very similar to Function as a Service capabilities.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"h1yPspBo5p"}],"key":"LpYtoEgOab"},{"type":"image","url":"/a3e154464638fb32cf560b6de9c384d8.svg","key":"j5a1gKUEpm","urlSource":"https://docs.dask.org/en/latest/_images/map-reduce-task-scheduling.svg"}],"key":"qjvMvSu6LO"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from time import sleep as wait\n\ndef apply_myfunc(x):\n    wait(1)\n    return x+1","visibility":"show","key":"agPAd5MWpB"},{"type":"output","id":"tzb_t4vf_taI58nB8H1PL","data":[],"visibility":"show","key":"Jbnc6CVITv"}],"visibility":"show","key":"ZDnXFiF71a"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We want to run ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YlXO6Zaw4f"},{"type":"inlineCode","value":"apply_myfunc()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PoHJBUNTKk"},{"type":"text","value":" on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SQbjpi1lZ6"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Central Site","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jw4jg5VoVI"}],"key":"luY8RcQaKG"},{"type":"text","value":" and wait for all results to be ready. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L3ny73ZTk7"},{"type":"inlineCode","value":"my_filelist_central","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QcLaJAK8dm"},{"type":"text","value":" represents a filelist to be processed by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kuEBMaI7su"},{"type":"inlineCode","value":"apply_myfunc()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tzVa0LrNEd"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rm4CRrKh2q"}],"key":"fhsDyhzywz"}],"key":"CbpD4GJOXi"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"my_filelist_central = range(20)\nwith myDEDLClusters.as_current(location=\"central\") as myclient:\n    central_future = myclient.map(apply_myfunc, my_filelist_central)\n    results_central = myclient.gather(central_future)","visibility":"show","key":"QDnf08TR5f"},{"type":"output","id":"CKm4kXjgyem8fpNbO8_8L","data":[],"visibility":"show","key":"Qbsoc3Z67Z"}],"visibility":"show","key":"besk6MHulO"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"results_central","visibility":"show","key":"l9XjPbQuHP"},{"type":"output","id":"zClLlShnmvMdhHl4kfKTv","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]","content_type":"text/plain"}}}],"visibility":"show","key":"XvtIQv8BNQ"}],"visibility":"show","key":"MNbJQSdHuH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run computation at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RvbN50zfrj"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LUMI bridge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j5Q73dVuJT"}],"key":"ug2bDnt8r9"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FfZwBAGMXx"}],"key":"P8A4A4XRLu"}],"key":"S3dI691HdF"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"my_filelist_lumi = range(32)\nwith myDEDLClusters.as_current(location=\"lumi\") as myclient:\n    lumi_future = myclient.map(apply_myfunc, my_filelist_lumi)\n    results_lumi = myclient.gather(lumi_future)","visibility":"show","key":"YTtBAoNcLB"},{"type":"output","id":"qykFGncDHwqP_HTw8nV3H","data":[],"visibility":"show","key":"oV5v3bL2OQ"}],"visibility":"show","key":"SGVYNVagH9"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"results_lumi","visibility":"show","key":"PZNnPGIEAq"},{"type":"output","id":"EKRO5KYKcG8dyyoecaVfg","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"[1,\n 2,\n 3,\n 4,\n 5,\n 6,\n 7,\n 8,\n 9,\n 10,\n 11,\n 12,\n 13,\n 14,\n 15,\n 16,\n 17,\n 18,\n 19,\n 20,\n 21,\n 22,\n 23,\n 24,\n 25,\n 26,\n 27,\n 28,\n 29,\n 30,\n 31,\n 32]","content_type":"text/plain"}}}],"visibility":"show","key":"bQQG8JsMT5"}],"visibility":"show","key":"FpaSKMyxFe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Limitations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gSxEOLyj7V"}],"identifier":"limitations","label":"Limitations","html_id":"limitations","implicit":true,"key":"fltGNDDeMH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Python libraries use in the local environment need to match, same version, with those available in the Dask Cluster. If this is not the case, you will get a warning, code might work but not guaranteed.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yu7mAzCBan"}],"key":"zwQPXtK9PY"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"No direct data exchange between Dask Workers across cloud locations possible. Each location acts as atmoic unit, however data can be easily exchanged via storage services such as S3.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HGlPeaxTDA"}],"key":"wC22Rwmgi1"}],"key":"Hq595snI62"}],"key":"BzGrU0Pe84"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use Case example: Pakistan Flood 2022","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ql7NLN29y4"}],"identifier":"use-case-example-pakistan-flood-2022","label":"Use Case example: Pakistan Flood 2022","html_id":"use-case-example-pakistan-flood-2022","implicit":true,"key":"KBghS1SVVi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The complete use case is available on GitHub via ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JfO4pEAKJG"},{"type":"link","url":"https://github.com/destination-earth/DestinE_EUMETSAT_PakistanFlood_2022","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/destination​-earth​/DestinE​_EUMETSAT​_PakistanFlood​_2022","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MhoW1vGLMr"}],"urlSource":"https://github.com/destination-earth/DestinE_EUMETSAT_PakistanFlood_2022","error":true,"key":"aP4PhOfHVK"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LUVLgvw8Db"}],"key":"yQB931wDTL"}],"key":"rdo3jD5Vrq"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The use case demonstrates the multi-cloud capabilities of DEDL following the paradigm of data proximate computing. Data of the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"N61SKGUSTb"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Global Flood Monitoring (GFM)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NavDBh0v2y"}],"key":"KKBNg0wCMk"},{"type":"text","value":" service as well as ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xcltA9cUXA"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Climate DT outputs, simulated by utilising ERA5 data","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bLBFHxJxXG"}],"key":"GBBkCvhXyJ"},{"type":"text","value":" have been use for flood risk assessment.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"l1euWyp1KZ"}],"key":"KdPwWIoiaM"},{"type":"image","url":"/fbe7b3a93dbabd237a3b9af41be26621.png","key":"mdD6f3prde","urlSource":"https://github.com/destination-earth/DestinE_EUMETSAT_PakistanFlood_2022/blob/main/img/DEDL_FloodUC_dataflow.png?raw=true"}],"key":"rlZ07NaLF8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data is stored as datacubes (zarr format) at Central Site and at LUMI bridge in object storage.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rzD8Pl9Pzg"}],"key":"ame6w935ew"}],"key":"Ig03yr7dSs"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import s3fs\nimport xarray as xr\n\nxr.set_options(keep_attrs=True)\n\ns3fs_central = s3fs.S3FileSystem(\n    anon=True,\n    use_ssl=True,\n    client_kwargs={\"endpoint_url\": \"https://s3.central.data.destination-earth.eu\"})\n\ns3fs_lumi = s3fs.S3FileSystem(\n    anon=True,\n    use_ssl=True,\n    client_kwargs={\"endpoint_url\": \"https://s3.lumi.data.destination-earth.eu\"})","visibility":"show","key":"Gsa1YiO7iF"},{"type":"output","id":"CjoIb1TOdMBM2pnyTX6tK","data":[],"visibility":"show","key":"tgRC1AZxvW"}],"visibility":"show","key":"Qp4FilQSjh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can list the data available at Central Site.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B0Tau5amfz"}],"key":"cNWO4auK9j"}],"key":"lp5h3Zh3G1"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"s3fs_central.ls(\"increment1-testdata\")","visibility":"show","key":"BLRt8XsQEu"},{"type":"output","id":"o-_AX4bJpfCQgXZH0-xrb","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"['increment1-testdata/2022-08-30.zarr', 'increment1-testdata/built_data.zarr']","content_type":"text/plain"}}}],"visibility":"show","key":"j4JiOfI6fv"}],"visibility":"show","key":"LagXdVxscK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read data stored in S3 bucket at Central Site. The data we want to read is a single Zarr data store representing the GFM flood data over Pakistan for 2022-08-30.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GHF404I4rz"}],"key":"S6g3R4IxIv"}],"key":"UHj0vjJFxE"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"flood_map = xr.open_zarr(store=s3fs.S3Map(root=f\"increment1-testdata/2022-08-30.zarr\", s3=s3fs_central, check=False),\n                         decode_coords=\"all\",)[\"flood\"].assign_attrs(location=\"central\", resolution=20)\n#flood_map","visibility":"show","key":"hGPlGWBqG3"},{"type":"output","id":"GIrlKuwNPh4P32Swaa1Y5","data":[],"visibility":"show","key":"HLhcYSAX8E"}],"visibility":"show","key":"qD0LhXX6g0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now want to run simple computation and compute the flooded area for the this day in August 2022.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YOpFWIqL5u"}],"key":"pIqRqa5VCf"}],"key":"AtaR3CLlro"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"flooded_area_ = flood_map.sum()*20*20/1000.\n#flooded_area_","visibility":"show","key":"zYxHkPMlGw"},{"type":"output","id":"DeVUhbZTdAp_tNdxMPvAz","data":[],"visibility":"show","key":"jcCcVOhleg"}],"visibility":"show","key":"YGrqtTuhSq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So far we haven’t computed anything, so lets do the computation now on the Dask cluster.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IPXuJSAsE7"}],"key":"vAt7oKzUl0"}],"key":"BS3sSIZQ4c"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from rich.console import Console\nfrom rich.prompt import Prompt\nconsole = Console()\n\nflooded_area = myDEDLClusters.compute(flooded_area_, sync=True)\nconsole.print(f\"Flooded area: {flooded_area.data} km2\")","visibility":"show","key":"WrEi8tJJaG"},{"type":"output","id":"SPomFrrs3-G4L10vRgGsv","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Flooded area: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18991614.0</span> km2\n</pre>\n","content_type":"text/html"},"text/plain":{"content":"Flooded area: \u001b[1;36m18991614.0\u001b[0m km2\n","content_type":"text/plain"}}}],"visibility":"show","key":"MkGVOrszpf"}],"visibility":"show","key":"EhxzrEYQM0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"How was that processing routed to Dask Gateway at Central Site","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qe3l1MyPCu"}],"key":"g2DGh0SZPi"},{"type":"text","value":"?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wk0lIBxDPa"}],"key":"ecfRBucQMH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"myDEDLClusters.compute(flooded_area_, sync=True)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h8HfoZgGw7"},{"type":"text","value":" checks for annotations (attributes) of array and maps that to available Dask Clusters.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Dx8pwVYsPa"}],"key":"WCziLq9k1Y"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Preprocess GFM data at ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CymtgxSrqk"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Central Site","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lpBJ0G3uHZ"}],"key":"oNiBS2RoWj"},{"type":"text","value":" for visualiation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"G978PfwjIq"}],"key":"Tm8RdKBy0t"}],"key":"ezIASF9WxA"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def preprocess_dataset(data_array: xr.DataArray, method: str):\n    data_array = data_array.squeeze()\n    steps = 500 // data_array.attrs[\"resolution\"]\n    coarsened = data_array.coarsen({'y': steps, 'x': steps}, boundary='trim')\n    if method == 'median':\n        data_array = (coarsened.median() > 0).astype('float32')\n    elif method == 'mean':\n        data_array = coarsened.mean()\n    elif method == 'max':\n        data_array = coarsened.max()\n    else:\n        raise NotImplementedError(method)\n    return data_array","visibility":"show","key":"VvzEs7uFOL"},{"type":"output","id":"8wFH4X_9V1E46MB6V-xxm","data":[],"visibility":"show","key":"x9UI9Kudam"}],"visibility":"show","key":"MLfBYWBlmf"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"flood_prep_ = preprocess_dataset(flood_map, 'median')","visibility":"show","key":"tfsqtHIjD8"},{"type":"output","id":"BzNwz2ytW4_5XoDVOpUi2","data":[],"visibility":"show","key":"Kt2ftBfAWx"}],"visibility":"show","key":"wu31JvZCk4"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nflood_prep = myDEDLClusters.compute(flood_prep_, sync=True)\nflood_prep.rio.write_crs(\"epsg:4326\", inplace=True)\nflood_prep = flood_prep.rio.reproject(f\"EPSG:3857\", nodata=np.nan)","visibility":"show","key":"AExDpCJyoU"},{"type":"output","id":"7Rp1felOa865F7Rqj3BJj","data":[],"visibility":"show","key":"iUTwDPuvMZ"}],"visibility":"show","key":"lII5dNwdQs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualise flood data on map.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ENeqY2XEU5"}],"key":"T4S0YLDlxq"}],"key":"upUsDYO18i"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import leafmap\nfrom attr import dataclass\n\n@dataclass\nclass Extent:\n    min_x: float\n    min_y: float\n    max_x: float\n    max_y: float\n    crs: str\n    def get_center(self):\n        return (np.mean([self.min_y, self.max_y]),\n                np.mean([self.min_x,self.max_x]))\n\n\nroi_extent = Extent(65, 21, 71, 31, crs='EPSG:4326')\n\nm = leafmap.Map(center=roi_extent.get_center(),\n                zoom=8, height=600)\nm.add_raster(flood_prep, colormap=\"Blues\", layer_name=\"Flood\", nodata=0.)\n\nm","visibility":"show","key":"bukdBccVdd"},{"type":"output","id":"rHhsn48xYQ4_WQqSbHix4","data":[{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"8b9c7249181848be8d4dd6f40304ec7b\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"Map(center=[26.0, 68.0], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title', 'zoom_out…","content_type":"text/plain"}}}],"visibility":"show","key":"PnaEQ9Cigt"}],"visibility":"show","key":"Ewu7si4orP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read data stored in S3 bucket at LUMI bridge (Finland). Data we want to read is a datacube generated from ERA-5 representing predicted rainfall data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vvXAEwU50g"}],"key":"VJC9cyG8Mk"}],"key":"Tt1bCLzjaW"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"rainfall = xr.open_zarr(store=s3fs.S3Map(root=f\"increment1-testdata/predicted_rainfall.zarr\",\n                                         s3=s3fs_lumi,\n                                         check=False),\n                        decode_coords=\"all\",)[\"tp\"].assign_attrs(location=\"lumi\", resolution=20)","visibility":"show","key":"UAARGVvadl"},{"type":"output","id":"GiQOKKzohPjUCg250gnXd","data":[],"visibility":"show","key":"UiLUOH5cT2"}],"visibility":"show","key":"sNr8jGnnDe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And again run the computation close to the data, therefore at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bWTwydowQ8"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LUMI bridge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lebRmE5jhE"}],"key":"f29tQxqETp"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WfCXzyY0AN"}],"key":"MP3W7Q8wtj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"First we compute the accumulated rainfall over Pakistan.\nSecondly we compute the average rainfall for August 2022 (monthly mean) at global scale.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fQnL14ckbF"}],"key":"aAAwgDnuTx"}],"key":"o69zngVcuV"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from datetime import datetime\n\ndef accum_rain_predictions(rain_data, startdate, enddate, extent):\n    rain_ = rain_data.sel(time=slice(startdate, enddate),\n                          latitude=slice(extent.max_y, extent.min_y),\n                          longitude=slice(extent.min_x, extent.max_x))\n    return rain_.cumsum(dim=\"time\", keep_attrs=True)*1000\n\n# compute accumulated rainfall over Pakistan\nacc_rain_ = accum_rain_predictions(rainfall, startdate=datetime(2022, 8, 18),\n                                                  enddate=datetime(2022, 8, 30),\n                                                  extent=roi_extent)\nacc_rain_ = acc_rain_.rename({\"longitude\":\"x\", \"latitude\":\"y\"})","visibility":"show","key":"TIWfE7tZi4"},{"type":"output","id":"fchqBchAs940dNz_2qB3N","data":[],"visibility":"show","key":"Ctyv1daYtv"}],"visibility":"show","key":"bWYQqlDrRS"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"acc_rain = myDEDLClusters.compute(acc_rain_, sync=True)","visibility":"show","key":"GVYIzVOWV7"},{"type":"output","id":"aW-XXnVl1_j3y9LtR35pz","data":[],"visibility":"show","key":"aTCt1D7KPE"}],"visibility":"show","key":"s7RRtVSaIy"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def acc_rain_reproject(rain):\n    from rasterio.enums import Resampling\n    rain.rio.write_nodata(0, inplace=True)\n    rain.rio.write_crs('EPSG:4326', inplace=True)\n    return rain.rio.reproject('EPSG:3857', resolution=500, resampling=Resampling.bilinear)\n\nacc_rain = acc_rain_reproject(acc_rain)","visibility":"show","key":"W6pTMBOJul"},{"type":"output","id":"pv2okCOG07d3vPb0DbaKm","data":[],"visibility":"show","key":"O4h4Qw0Hpl"}],"visibility":"show","key":"uqOHWr2S17"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualise forecast data provided by the Digital Twin which could have been used for flood risk assessment or even alerting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LpjAKlkyLF"}],"key":"hHaAus2zGf"}],"key":"d9w795phuT"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"time_dim_len = acc_rain.shape[0]\nfor day in range(0, time_dim_len):\n    fpath_str = f\"./{day}.tif\"\n    acc_rain[day,:].rio.to_raster(fpath_str,\n                                  driver=\"COG\",\n                                  overview_count=10)","visibility":"show","key":"rsncy8MunC"},{"type":"output","id":"qJzwukeN04jCxQGK-_qv5","data":[],"visibility":"show","key":"lBHTI2rYaQ"}],"visibility":"show","key":"EfmARfyJNW"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import leafmap\nfrom localtileserver import get_leaflet_tile_layer\n\nm = leafmap.Map(center=roi_extent.get_center(),\n                zoom=6, height=600)\n\nlayer_dict = {}\ndate_vals = np.datetime_as_string(acc_rain[\"time\"].values, unit='D')\nfor day in range(0, time_dim_len):\n    layer_dict[date_vals[day]]= get_leaflet_tile_layer(f\"./{day}.tif\",\n                                                       colormap=\"Blues\",\n                                                       indexes=[1],\n                                                       nodata=0.,\n                                                       vmin=acc_rain.min().values,\n                                                       vmax=acc_rain.max().values,\n                                                       opacity=0.85)\n\nm.add_local_tile(flood_prep,\n                 colormap=\"Blues\",\n                 nodata=0.)\nm.add_time_slider(layer_dict,\n                  layer=\"Accumluated Rainfall\",\n                  time_interval=1.)\nm","visibility":"show","key":"nchn8RB1Pn"},{"type":"output","id":"iAHP4UixH8nhhjim6eyUO","data":[],"visibility":"show","key":"bQU7tPN4pT"}],"visibility":"show","key":"hW75ukd7TO"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"myDEDLClusters.shutdown()","visibility":"show","key":"fBw24eccX5"},{"type":"output","id":"L5cnF7KCblLN1hRnuPzW9","data":[],"visibility":"show","key":"f0U40O4XOO"}],"visibility":"show","key":"aELDWVw0cN"}],"key":"YTWqXy2w2u"},"references":{"cite":{"order":[],"data":{}}}}